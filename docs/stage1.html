<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rocío Beasaín MD">
<meta name="author" content="Verónica Fernandez MD">
<meta name="author" content="Francisco Sepulveda MD">
<meta name="author" content="Amaru Simón Agüero Jiménez">
<meta name="dcterms.date" content="2025-09-21">

<title>Intracranial Hypertension</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="stage1_files/libs/clipboard/clipboard.min.js"></script>
<script src="stage1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="stage1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="stage1_files/libs/quarto-html/popper.min.js"></script>
<script src="stage1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="stage1_files/libs/quarto-html/anchor.min.js"></script>
<link href="stage1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="stage1_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="stage1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="stage1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="stage1_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="stage1_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="stage1_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="stage1_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="stage1_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="stage1_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="stage1_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="stage1_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="stage1_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<script src="stage1_files/libs/jszip-1.13.6/jszip.min.js"></script>

<script src="stage1_files/libs/pdfmake-1.13.6/pdfmake.js"></script>

<script src="stage1_files/libs/pdfmake-1.13.6/vfs_fonts.js"></script>

<link href="stage1_files/libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="stage1_files/libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="stage1_files/libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="stage1_files/libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="stage1_files/libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="stage1_files/libs/dt-ext-fixedcolumns-1.13.6/css/fixedColumns.dataTables.min.css" rel="stylesheet">

<script src="stage1_files/libs/dt-ext-fixedcolumns-1.13.6/js/dataTables.fixedColumns.min.js"></script>

<link href="stage1_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="stage1_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#frisen-1-5" id="toc-frisen-1-5" class="nav-link active" data-scroll-target="#frisen-1-5"><span class="header-section-number">1</span> Frisen 1-5</a></li>
  <li><a href="#frisen-4-5" id="toc-frisen-4-5" class="nav-link" data-scroll-target="#frisen-4-5"><span class="header-section-number">2</span> Frisen 4-5</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intracranial Hypertension</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Rocío Beasaín MD </p>
             <p>Verónica Fernandez MD </p>
             <p>Francisco Sepulveda MD </p>
             <p>Amaru Simón Agüero Jiménez <a href="mailto:aaguero@miaundes.cl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7336-1833" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="frisen-1-5" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Frisen 1-5</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS COMPLETO DE HIPERTENSIÓN INTRACRANEAL - HIPERTENSIÓN 1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Versión adaptada para datos con variables por ojo (OD/OI)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluye todas las tablas y figuras del análisis original</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CARGA DE PAQUETES</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para instalar/cargar paquetes</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>use_packages <span class="ot">&lt;-</span> <span class="cf">function</span>(pkgs){</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  new_pkgs <span class="ot">&lt;-</span> pkgs[<span class="sc">!</span>(pkgs <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()))]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(new_pkgs)) <span class="fu">install.packages</span>(new_pkgs, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="fu">lapply</span>(pkgs, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">use_packages</span>(<span class="fu">c</span>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DT"</span>, <span class="st">"readxl"</span>, <span class="st">"tidyverse"</span>, <span class="st">"rstatix"</span>, <span class="st">"MASS"</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pROC"</span>, <span class="st">"epitools"</span>, <span class="st">"stringr"</span>, <span class="st">"ggpubr"</span>, <span class="st">"plotly"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"broom.mixed"</span>, <span class="st">"htmlwidgets"</span>, <span class="st">"tableone"</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># CARGA Y PREPROCESAMIENTO DE DATOS</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para encontrar el directorio raíz del proyecto</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>project_root <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  qdir <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"QUARTO_PROJECT_DIR"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(qdir)) <span class="fu">return</span>(<span class="fu">normalizePath</span>(qdir, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">current_input</span>()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ci) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(ci) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nzchar</span>(ci)) {</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(ci, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">dirname</span>(p)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">basename</span>(d) <span class="sc">==</span> <span class="st">"docs"</span>) <span class="fu">return</span>(<span class="fu">dirname</span>(d))</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(d)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  od <span class="ot">&lt;-</span> knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">get</span>(<span class="st">"output.dir"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(od) <span class="sc">&amp;&amp;</span> <span class="fu">nzchar</span>(od)) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    od <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(od, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">basename</span>(od) <span class="sc">==</span> <span class="st">"docs"</span>) <span class="fu">return</span>(<span class="fu">dirname</span>(od))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(od)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  cur <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="fu">getwd</span>(), <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dir.exists</span>(<span class="fu">file.path</span>(cur, <span class="st">"data"</span>))) <span class="fu">return</span>(cur)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    nxt <span class="ot">&lt;-</span> <span class="fu">dirname</span>(cur)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">identical</span>(nxt, cur)) <span class="cf">break</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    cur <span class="ot">&lt;-</span> nxt</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  cur</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>root_dir <span class="ot">&lt;-</span> <span class="fu">project_root</span>()</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(root_dir, <span class="st">"data"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>find_data <span class="ot">&lt;-</span> <span class="cf">function</span>(pattern){</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">list.files</span>(data_dir, <span class="at">pattern =</span> pattern, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(f) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"Archivo no encontrado: "</span>, pattern, <span class="st">" en "</span>, data_dir)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  f[[<span class="dv">1</span>]]</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar archivo de datos - Hipertensión 1</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>file_hiper1 <span class="ot">&lt;-</span> <span class="fu">find_data</span>(<span class="st">"Hipertensi[oó]n</span><span class="sc">\\</span><span class="st">.xlsx$|Hipertensi[oó]n1</span><span class="sc">\\</span><span class="st">.xlsx$"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer la hoja "RM 1 y RM 2" con tipos de columnas específicos</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>col_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"text"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"date"</span>, <span class="dv">2</span>), <span class="st">"text"</span>, <span class="fu">rep</span>(<span class="st">"numeric"</span>, <span class="dv">65</span>), <span class="st">"text"</span>, <span class="st">"text"</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>Hiper1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_hiper1, <span class="at">sheet =</span> <span class="st">"RM 1 y RM 2"</span>, <span class="at">col_types =</span> col_types)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Corregir nombres de columnas duplicadas</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Hiper1) <span class="ot">&lt;-</span> <span class="fu">make.unique</span>(<span class="fu">names</span>(Hiper1), <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co"># EXTRACCIÓN DEL SEXO A PARTIR DEL NOMBRE</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>extract_sex <span class="ot">&lt;-</span> <span class="cf">function</span>(names_vector) {</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  names_upper <span class="ot">&lt;-</span> <span class="fu">toupper</span>(<span class="fu">trimws</span>(names_vector))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  male_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JUAN"</span>, <span class="st">"JOSE"</span>, <span class="st">"PEDRO"</span>, <span class="st">"CARLOS"</span>, <span class="st">"LUIS"</span>, <span class="st">"JORGE"</span>, <span class="st">"ALBERTO"</span>, </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"FRANCISCO"</span>, <span class="st">"ANTONIO"</span>, <span class="st">"MIGUEL"</span>, <span class="st">"MANUEL"</span>, <span class="st">"FERNANDO"</span>, <span class="st">"SERGIO"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"RICARDO"</span>, <span class="st">"EDUARDO"</span>, <span class="st">"MARIO"</span>, <span class="st">"ROBERTO"</span>, <span class="st">"DANIEL"</span>, <span class="st">"PABLO"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"ALEJANDRO"</span>, <span class="st">"ANDRES"</span>, <span class="st">"DIEGO"</span>, <span class="st">"RAFAEL"</span>, <span class="st">"RAMON"</span>, <span class="st">"VICTOR"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"MARTIN"</span>, <span class="st">"RAUL"</span>, <span class="st">"OSCAR"</span>, <span class="st">"ALFONSO"</span>, <span class="st">"ARTURO"</span>, <span class="st">"ENRIQUE"</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"GERARDO"</span>, <span class="st">"HECTOR"</span>, <span class="st">"JAVIER"</span>, <span class="st">"JESUS"</span>, <span class="st">"MARCO"</span>, <span class="st">"OMAR"</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  female_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MARIA"</span>, <span class="st">"ANA"</span>, <span class="st">"LAURA"</span>, <span class="st">"PATRICIA"</span>, <span class="st">"CARMEN"</span>, <span class="st">"ROSA"</span>, <span class="st">"SOFIA"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"GABRIELA"</span>, <span class="st">"ELENA"</span>, <span class="st">"MARTHA"</span>, <span class="st">"LUCIA"</span>, <span class="st">"ANDREA"</span>, <span class="st">"ADRIANA"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"MONICA"</span>, <span class="st">"TERESA"</span>, <span class="st">"CLAUDIA"</span>, <span class="st">"BEATRIZ"</span>, <span class="st">"SANDRA"</span>, <span class="st">"VERONICA"</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"ALEJANDRA"</span>, <span class="st">"LETICIA"</span>, <span class="st">"GLORIA"</span>, <span class="st">"ISABEL"</span>, <span class="st">"NORMA"</span>, <span class="st">"ALICIA"</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SILVIA"</span>, <span class="st">"GUADALUPE"</span>, <span class="st">"BLANCA"</span>, <span class="st">"MARGARITA"</span>, <span class="st">"JULIA"</span>, <span class="st">"PAULA"</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"DANIELA"</span>, <span class="st">"CAROLINA"</span>, <span class="st">"NATALIA"</span>, <span class="st">"VALERIA"</span>, <span class="st">"FERNANDA"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  sex <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="fu">length</span>(names_vector))</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(names_vector)) {</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(names_upper[i]) <span class="sc">||</span> names_upper[i] <span class="sc">==</span> <span class="st">""</span>) {</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>      sex[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>      first_name <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(names_upper[i], <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (first_name <span class="sc">%in%</span> male_names) {</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>        sex[i] <span class="ot">&lt;-</span> <span class="st">"Male"</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (first_name <span class="sc">%in%</span> female_names) {</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>        sex[i] <span class="ot">&lt;-</span> <span class="st">"Female"</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"A$|E$"</span>, first_name)) {</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Female"</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"O$|[^AEIOU]$"</span>, first_name)) {</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Male"</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sex)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar sexo al dataframe</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>Hiper1<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">extract_sex</span>(Hiper1<span class="sc">$</span>NOMBRE)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>Hiper1<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(Hiper1<span class="sc">$</span>Sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Unknown"</span>))</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR DATASET EXPANDIDO POR OJO</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear dataset largo con una fila por ojo para análisis de atrofia/Frisen</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>Hiper1_eyes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  Hiper1 <span class="sc">%&gt;%</span> </span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Frisen =</span> <span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Eye =</span> <span class="st">"OD"</span>),</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  Hiper1 <span class="sc">%&gt;%</span> </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Frisen =</span> <span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Eye =</span> <span class="st">"OI"</span>)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCIONES AUXILIARES</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para limpiar nombres de columnas</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>clean_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(I</span><span class="sc">\\</span><span class="st">)_"</span>, <span class="st">""</span>, x)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(II</span><span class="sc">\\</span><span class="st">)_"</span>, <span class="st">""</span>, x)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_1$|_2$"</span>, <span class="st">""</span>, x)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, x)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">..*"</span>, <span class="st">""</span>, x)</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">trimws</span>(x)</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de traducción ampliada (CORREGIDA)</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>translate_var <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  translations <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Edad"</span> <span class="ot">=</span> <span class="st">"Age"</span>,</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"EDAD"</span> <span class="ot">=</span> <span class="st">"Age"</span>,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sexo"</span> <span class="ot">=</span> <span class="st">"Sex"</span>,</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sex"</span> <span class="ot">=</span> <span class="st">"Sex"</span>,</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del NO"</span> <span class="ot">=</span> <span class="st">"ON width"</span>,</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Virchow Robin medida"</span> <span class="ot">=</span> <span class="st">"Virchow Robin measurement"</span>,</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel width"</span>,</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Circunferencia del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel circumference"</span>,</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del 3ro"</span> <span class="ot">=</span> <span class="st">"3rd ventricle width"</span>,</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Altura del Aracnoidocele"</span> <span class="ot">=</span> <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Descenso tonsilar cuantitativo"</span> <span class="ot">=</span> <span class="st">"Quantitative tonsillar descent"</span>,</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Espesor del TCS nucal"</span> <span class="ot">=</span> <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distancia talamomesencefalica"</span> <span class="ot">=</span> <span class="st">"Thalamo-mesencephalic distance"</span>,</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Atrio"</span> <span class="ot">=</span> <span class="st">"Atrium"</span>,</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"VL frontal"</span> <span class="ot">=</span> <span class="st">"Frontal VL"</span>,</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tercer Ventriculo"</span> <span class="ot">=</span> <span class="st">"Third Ventricle"</span>,</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Presión LCR"</span> <span class="ot">=</span> <span class="st">"CSF Pressure"</span>,</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tiempo sin ACTZ"</span> <span class="ot">=</span> <span class="st">"Time without ACTZ"</span>,</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Válvula derivativa"</span> <span class="ot">=</span> <span class="st">"Shunt valve"</span>,</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia"</span> <span class="ot">=</span> <span class="st">"ON atrophy"</span>,</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia OD"</span> <span class="ot">=</span> <span class="st">"ON atrophy RE"</span>,</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia OI"</span> <span class="ot">=</span> <span class="st">"ON atrophy LE"</span>,</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen"</span> <span class="ot">=</span> <span class="st">"Frisen Grade"</span>,</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen OD"</span> <span class="ot">=</span> <span class="st">"Frisen Grade RE"</span>,</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen OI"</span> <span class="ot">=</span> <span class="st">"Frisen Grade LE"</span>,</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención de vainas NO"</span> <span class="ot">=</span> <span class="st">"ON sheath distention"</span>,</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención III NC"</span> <span class="ot">=</span> <span class="st">"CN III distention"</span>,</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención  NC"</span> <span class="ot">=</span> <span class="st">"CN distention"</span>,</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aplanamiento posterior del globo"</span> <span class="ot">=</span> <span class="st">"Posterior globe flattening"</span>,</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Protrusión del disco óptico"</span> <span class="ot">=</span> <span class="st">"Optic disc protrusion"</span>,</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Realce del NO"</span> <span class="ot">=</span> <span class="st">"ON enhancement"</span>,</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meckel prominente"</span> <span class="ot">=</span> <span class="st">"Prominent Meckel"</span>,</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Forma del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel shape"</span>,</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Granulaciones Aracnoideas"</span> <span class="ot">=</span> <span class="st">"Arachnoid granulations"</span>,</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aracnoidocele Selar"</span> <span class="ot">=</span> <span class="st">"Sellar arachnoidocele"</span>,</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Silla turca amplia aracnoidocele expansivo"</span> <span class="ot">=</span> <span class="st">"Enlarged sella turcica with expansive arachnoidocele"</span>,  <span class="co"># CORREGIDA</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Silla turca amplia (aracnoidocele expansivo)"</span> <span class="ot">=</span> <span class="st">"Enlarged sella turcica with expansive arachnoidocele"</span>, <span class="co"># AGREGADA</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meningocele"</span> <span class="ot">=</span> <span class="st">"Meningocele"</span>,</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meningoencefalocele"</span> <span class="ot">=</span> <span class="st">"Meningoencephalocele"</span>,</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Descenso tonsilar"</span> <span class="ot">=</span> <span class="st">"Tonsillar descent"</span>,</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Estenosis seno sigmoideo"</span> <span class="ot">=</span> <span class="st">"Sigmoid sinus stenosis"</span>,</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cefalea crónica"</span> <span class="ot">=</span> <span class="st">"Chronic headache"</span>,</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Otra Cx"</span> <span class="ot">=</span> <span class="st">"Other surgery"</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(old <span class="cf">in</span> <span class="fu">names</span>(translations)) {</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(old, translations[old], x)</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Función combinada para visualización</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>clean_and_translate <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">translate_var</span>(<span class="fu">clean_names</span>(x))</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="co"># TABLA 0: DESCRIPCIÓN COMPLETA DE LA MUESTRA BASAL (VERSIÓN MEJORADA)</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Reemplazar la sección original de TABLA 0 con este código</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para formatear estadísticas continuas</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>format_continuous <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  vals <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data[[var]])</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(vals) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, <span class="fu">mean</span>(vals), <span class="fu">sd</span>(vals)))</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"NA"</span>)</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para formatear estadísticas categóricas</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>format_categorical <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, <span class="at">category =</span> <span class="st">"Present"</span>) {</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.factor</span>(data[[var]]) <span class="sc">||</span> <span class="fu">is.character</span>(data[[var]])) {</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[var]])</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (category <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[category]</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"Female"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para variable Sex, mostrar Female</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[<span class="st">"Female"</span>]</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[<span class="st">"Yes"</span>]</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para variables multiclase como Frisen, mostrar distribución completa</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">"%s: %d (%.1f)"</span>, </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">names</span>(tbl), tbl, (tbl<span class="sc">/</span>n_total)<span class="sc">*</span><span class="dv">100</span>), </span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collapse =</span> <span class="st">"; "</span>)</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(result)</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"NA"</span>)</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos basales usando el dataset Hiper1 (a nivel paciente, no expandido)</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>descriptive_data <span class="ot">&lt;-</span> Hiper1 <span class="sc">%&gt;%</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables demográficas y clínicas</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> Edad,</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">CSF_Pressure =</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>,</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_without_ACTZ =</span> <span class="st">`</span><span class="at">Tiempo sin ACTZ</span><span class="st">`</span>,</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables numéricas tiempo 1 (basales)</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del NO</span><span class="st">`</span>,</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">Virchow_Robin_T1 =</span> <span class="st">`</span><span class="at">(I)_Virchow Robin medida</span><span class="st">`</span>,</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del Meckel</span><span class="st">`</span>, </span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_circumference_T1 =</span> <span class="st">`</span><span class="at">(I)_Circunferencia del Meckel</span><span class="st">`</span>,</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">Third_ventricle_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del 3ro</span><span class="st">`</span>,</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">Arachnoidocele_height_T1 =</span> <span class="st">`</span><span class="at">(I)_Altura del Aracnoidocele</span><span class="st">`</span>,</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tonsillar_descent_T1 =</span> <span class="st">`</span><span class="at">(I)_Descenso tonsilar cuantitativo</span><span class="st">`</span>,</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nuchal_SCT_T1 =</span> <span class="st">`</span><span class="at">(I)_Espesor del TCS nucal</span><span class="st">`</span>,</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">Thalamo_mesencephalic_T1 =</span> <span class="st">`</span><span class="at">(I)_Distancia talamomesencefalica</span><span class="st">`</span>,</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">Atrium_T1 =</span> <span class="st">`</span><span class="at">(I)_Atrio</span><span class="st">`</span>,</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frontal_VL_T1 =</span> <span class="st">`</span><span class="at">(I)_VL frontal</span><span class="st">`</span>,</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">Third_ventricle_T1 =</span> <span class="st">`</span><span class="at">(I)_Tercer Ventriculo</span><span class="st">`</span>,</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de atrofia y grado por ojo</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shunt_valve =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_atrophy_OD =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_atrophy_OI =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frisen_Grade_OD =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>),</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frisen_Grade_OI =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>),</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chronic_headache =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Cefalea crónica</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_surgery =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Otra Cx</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables categóricas tiempo 1</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_sheath_distention_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención de vainas NO</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">CN_III_distention_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención III NC</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posterior_globe_flattening_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aplanamiento posterior del globo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">Optic_disc_protrusion_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Protrusión del disco óptico</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_enhancement_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Realce del NO</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prominent_Meckel_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meckel prominente</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_shape_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Forma del Meckel</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type3"</span>)),</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">Arachnoid_granulations_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Granulaciones Aracnoideas</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meningocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningocele</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meningoencephalocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningoencefalocele</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sellar_arachnoidocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aracnoidocele Selar</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">Enlarged_sella_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tonsillar_descent_cat_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Descenso tonsilar</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigmoid_stenosis_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Estenosis seno sigmoideo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> Sex</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular n para cada grupo</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(descriptive_data)</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>n_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(descriptive_data<span class="sc">$</span>Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>n_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(descriptive_data<span class="sc">$</span>Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla descriptiva completa</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>TABLA0_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables demográficas</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>demo_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Age"</span>, <span class="at">name =</span> <span class="st">"Age (years)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sex"</span>, <span class="at">name =</span> <span class="st">"Sex (Female)"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"CSF_Pressure"</span>, <span class="at">name =</span> <span class="st">"CSF Pressure (cmH2O)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Time_without_ACTZ"</span>, <span class="at">name =</span> <span class="st">"Time without ACTZ (days)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de imagen cuantitativas</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>imaging_quant_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_width_T1"</span>, <span class="at">name =</span> <span class="st">"ON width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Virchow_Robin_T1"</span>, <span class="at">name =</span> <span class="st">"Virchow Robin measurement (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_width_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_circumference_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel circumference (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Third_ventricle_width_T1"</span>, <span class="at">name =</span> <span class="st">"3rd ventricle width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Arachnoidocele_height_T1"</span>, <span class="at">name =</span> <span class="st">"Arachnoidocele height (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Tonsillar_descent_T1"</span>, <span class="at">name =</span> <span class="st">"Tonsillar descent (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Nuchal_SCT_T1"</span>, <span class="at">name =</span> <span class="st">"Nuchal SCT thickness (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Thalamo_mesencephalic_T1"</span>, <span class="at">name =</span> <span class="st">"Thalamo-mesencephalic distance (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Atrium_T1"</span>, <span class="at">name =</span> <span class="st">"Atrium (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frontal_VL_T1"</span>, <span class="at">name =</span> <span class="st">"Frontal VL (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Third_ventricle_T1"</span>, <span class="at">name =</span> <span class="st">"Third Ventricle (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de atrofia y grado por ojo</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>atrophy_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_atrophy_OD"</span>, <span class="at">name =</span> <span class="st">"ON atrophy OD"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_atrophy_OI"</span>, <span class="at">name =</span> <span class="st">"ON atrophy OI"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frisen_Grade_OD"</span>, <span class="at">name =</span> <span class="st">"Frisen Grade OD"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frisen_Grade_OI"</span>, <span class="at">name =</span> <span class="st">"Frisen Grade OI"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Chronic_headache"</span>, <span class="at">name =</span> <span class="st">"Chronic headache"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Other_surgery"</span>, <span class="at">name =</span> <span class="st">"Other surgery"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de signos de imagen categóricas</span></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>imaging_cat_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_sheath_distention_T1"</span>, <span class="at">name =</span> <span class="st">"ON sheath distention"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"CN_III_distention_T1"</span>, <span class="at">name =</span> <span class="st">"CN III distention"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Posterior_globe_flattening_T1"</span>, <span class="at">name =</span> <span class="st">"Posterior globe flattening"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Optic_disc_protrusion_T1"</span>, <span class="at">name =</span> <span class="st">"Optic disc protrusion"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_enhancement_T1"</span>, <span class="at">name =</span> <span class="st">"ON enhancement"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Prominent_Meckel_T1"</span>, <span class="at">name =</span> <span class="st">"Prominent Meckel"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_shape_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel shape"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Arachnoid_granulations_T1"</span>, <span class="at">name =</span> <span class="st">"Arachnoid granulations"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meningocele_T1"</span>, <span class="at">name =</span> <span class="st">"Meningocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meningoencephalocele_T1"</span>, <span class="at">name =</span> <span class="st">"Meningoencephalocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sellar_arachnoidocele_T1"</span>, <span class="at">name =</span> <span class="st">"Sellar arachnoidocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Enlarged_sella_T1"</span>, <span class="at">name =</span> <span class="st">"Enlarged sella turcica"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Tonsillar_descent_cat_T1"</span>, <span class="at">name =</span> <span class="st">"Tonsillar descent (categorical)"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sigmoid_stenosis_T1"</span>, <span class="at">name =</span> <span class="st">"Sigmoid sinus stenosis"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todas las variables</span></span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>all_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(demo_vars, imaging_quant_vars, atrophy_vars, imaging_cat_vars)</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear filas de la tabla</span></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> all_vars) {</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (v<span class="sc">$</span>cat) {</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables categóricas</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>    overall <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(descriptive_data, v<span class="sc">$</span>var)</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>    with_valve <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>), v<span class="sc">$</span>var)</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>    without_valve <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>), v<span class="sc">$</span>var)</span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test estadístico para categóricas</span></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Frisen"</span>, v<span class="sc">$</span>var)) {</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>      tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(descriptive_data[[v<span class="sc">$</span>var]], descriptive_data<span class="sc">$</span>Shunt_valve)</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ncol</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">min</span>(tbl) <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>          p_val <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(tbl)<span class="sc">$</span>p.value</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>          p_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(tbl))<span class="sc">$</span>p.value</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para Frisen Grade usar test no paramétrico</span></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(descriptive_data[[v<span class="sc">$</span>var]])) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="fu">as.numeric</span>(descriptive_data[[v<span class="sc">$</span>var]]) <span class="sc">~</span> descriptive_data<span class="sc">$</span>Shunt_valve)<span class="sc">$</span>p.value</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables continuas</span></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>    overall <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(descriptive_data, v<span class="sc">$</span>var)</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>    with_valve <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>), v<span class="sc">$</span>var)</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>    without_valve <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>), v<span class="sc">$</span>var)</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test t para continuas</span></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(descriptive_data[[v<span class="sc">$</span>var]])) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>      p_val <span class="ot">&lt;-</span> <span class="fu">t.test</span>(descriptive_data[[v<span class="sc">$</span>var]] <span class="sc">~</span> descriptive_data<span class="sc">$</span>Shunt_valve)<span class="sc">$</span>p.value</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>      p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>  TABLA0_rows[[<span class="fu">length</span>(TABLA0_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> v<span class="sc">$</span>name,</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">Overall =</span> overall,</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">With Valve</span><span class="st">`</span> <span class="ot">=</span> with_valve,</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Without Valve</span><span class="st">`</span> <span class="ot">=</span> without_valve,</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(p_val), <span class="st">"NA"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p_val)),</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>TABLA0_BASELINE <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA0_rows)</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Actualizar encabezados con números</span></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(TABLA0_BASELINE) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, </span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"Overall (n="</span>, n_total, <span class="st">")"</span>),</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"With Valve (n="</span>, n_valve, <span class="st">")"</span>),</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"Without Valve (n="</span>, n_no_valve, <span class="st">")"</span>),</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"p value"</span>)</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 1: VARIABLES CONTINUAS PRE-POST (NIVEL PACIENTE)</span></span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas para análisis pre-post</span></span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>HiperOrd <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">49</span><span class="sc">:</span><span class="dv">52</span>,<span class="dv">55</span><span class="sc">:</span><span class="dv">58</span>,<span class="dv">59</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">61</span><span class="sc">:</span><span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>,<span class="dv">71</span>)]</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar que las columnas sean numéricas (excepto la válvula)</span></span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>cols_to_check <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">26</span>)</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> cols_to_check) {</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>  HiperOrd[,col] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[col]])</span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar válvula derivativa</span></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>,</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas t pareadas y ANCOVA</span></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>ANCOVAS <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>TEMP <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>TTEST <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)) {</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>  ANCOVAS[[i]] <span class="ot">&lt;-</span> <span class="fu">aov</span>(HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]] <span class="sc">~</span> HiperOrd[[i]] <span class="sc">+</span> HiperOrd[[<span class="st">"Válvula derivativa"</span>]])</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>  TEMP[[i]] <span class="ot">&lt;-</span> <span class="fu">summary</span>(ANCOVAS[[i]])</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>  TTEST[[i]] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(HiperOrd[[i]], HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]], </span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>                        <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de resultados</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>TABLA1_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)) {</span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">colnames</span>(HiperOrd[,i]))</span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a>  vals_t1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[i]])</span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>  mean1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>  sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>  t1_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean1, sd1)</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>  vals_t2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>  mean2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>  sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>  t2_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean2, sd2)</span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>  valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"Yes"</span></span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>  no_valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"No"</span></span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>  vals_valve <span class="ot">&lt;-</span> vals_t2[valve_mask]</span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a>  mean_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>  sd_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>  valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_valve, sd_valve)</span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>  vals_no_valve <span class="ot">&lt;-</span> vals_t2[no_valve_mask]</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a>  mean_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>  sd_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>  no_valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_no_valve, sd_no_valve)</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>  TABLA1_rows[[<span class="fu">length</span>(TABLA1_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T1 (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> t1_stats,</span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> t2_stats,</span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Paired t)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, TTEST[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 with Valve</span><span class="st">`</span> <span class="ot">=</span> valve_stats,</span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 without Valve</span><span class="st">`</span> <span class="ot">=</span> no_valve_stats,</span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (ANCOVA)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, TEMP[[i]][[<span class="dv">1</span>]][<span class="dv">2</span>,<span class="dv">5</span>]),</span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>TABLA1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA1_rows)</span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 2: VARIABLES CATEGÓRICAS PRE-POST (NIVEL PACIENTE)</span></span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a>HiperOrd2 <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">18</span>,<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">27</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">33</span><span class="sc">:</span><span class="dv">36</span>,<span class="dv">37</span>,<span class="dv">39</span>,<span class="dv">41</span>,<span class="dv">42</span>,<span class="dv">45</span><span class="sc">:</span><span class="dv">48</span>,<span class="dv">53</span>,<span class="dv">54</span>,<span class="dv">64</span>,<span class="dv">66</span><span class="sc">:</span><span class="dv">70</span>)]</span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar variables</span></span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>factorizar <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">factor</span>(x, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a>HiperOrd2 <span class="ot">&lt;-</span> HiperOrd2 <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">30</span>), factorizar)</span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>HiperOrd2<span class="fl">.2</span> <span class="ot">&lt;-</span> HiperOrd2[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">30</span>)]</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de McNemar</span></span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>MNT <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>ODDS <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>PROP1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>PROP2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a>CHIT <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a>PROPVD <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a>ODDS2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">2</span>)){</span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>  MNT[[i]] <span class="ot">&lt;-</span> HiperOrd2<span class="fl">.2</span>[,<span class="fu">c</span>(i,i<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>  PROP1[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i])))</span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>  PROP2[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i<span class="sc">+</span><span class="dv">1</span>])))</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>  ODDS[[i]] <span class="ot">&lt;-</span> <span class="fu">mcnemar.test</span>(<span class="fu">table</span>(MNT[[i]]))</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>  CHIT[[i]] <span class="ot">&lt;-</span> HiperOrd2<span class="fl">.2</span>[,<span class="fu">c</span>(i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">27</span>)]</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>  PROPVD[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(CHIT[[i]])))</span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a>  ODDS2[[i]] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(CHIT[[i]])))</span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>TABLA2_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">2</span>)) {</span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">colnames</span>(HiperOrd2<span class="fl">.2</span>[,i]))</span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a>  tbl1 <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i])</span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl1)) {</span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> tbl1[<span class="st">"Yes"</span>]</span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a>    pct1 <span class="ot">&lt;-</span> (n1 <span class="sc">/</span> <span class="fu">sum</span>(tbl1)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a>    t1_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n1, pct1)</span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>    t1_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>  tbl2 <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl2)) {</span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> tbl2[<span class="st">"Yes"</span>]</span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>    pct2 <span class="ot">&lt;-</span> (n2 <span class="sc">/</span> <span class="fu">sum</span>(tbl2)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>    t2_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n2, pct2)</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>    t2_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a>  tbl_valve <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[HiperOrd2<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"Yes"</span>, i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>  tbl_no_valve <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[HiperOrd2<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"No"</span>, i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl_valve)) {</span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>    n_valve <span class="ot">&lt;-</span> tbl_valve[<span class="st">"Yes"</span>]</span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>    pct_valve <span class="ot">&lt;-</span> (n_valve <span class="sc">/</span> <span class="fu">sum</span>(tbl_valve)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>    valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n_valve, pct_valve)</span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>    valve_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl_no_valve)) {</span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a>    n_no_valve <span class="ot">&lt;-</span> tbl_no_valve[<span class="st">"Yes"</span>]</span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a>    pct_no_valve <span class="ot">&lt;-</span> (n_no_valve <span class="sc">/</span> <span class="fu">sum</span>(tbl_no_valve)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>    no_valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n_no_valve, pct_no_valve)</span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>    no_valve_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a>  TABLA2_rows[[<span class="fu">length</span>(TABLA2_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T1 n (%)</span><span class="st">`</span> <span class="ot">=</span> t1_stats,</span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 n (%)</span><span class="st">`</span> <span class="ot">=</span> t2_stats,</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (McNemar)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, ODDS[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 with Valve n (%)</span><span class="st">`</span> <span class="ot">=</span> valve_stats,</span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 without Valve n (%)</span><span class="st">`</span> <span class="ot">=</span> no_valve_stats,</span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Chi-square)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, ODDS2[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>TABLA2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA2_rows)</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 3: ANÁLISIS DE ATROFIA (TODOS LOS OJOS COMO UNIDADES)</span></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos para análisis de atrofia - todos los ojos juntos</span></span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="fu">seq</span>(<span class="dv">11</span>,<span class="dv">61</span>,<span class="dv">2</span>),<span class="dv">63</span><span class="sc">:</span><span class="dv">71</span>)]</span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificar y factorizar variables categóricas</span></span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM <span class="sc">%&gt;%</span> </span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">31</span>,<span class="dv">33</span>), </span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(<span class="sc">~</span><span class="fu">recode</span>(., <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>)))</span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM <span class="sc">%&gt;%</span> </span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">31</span>,<span class="dv">33</span>), </span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Absent"</span>,<span class="st">"Present"</span>))))</span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATOSM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">(I</span><span class="sc">\\</span><span class="st">)_'</span>,<span class="st">''</span>, <span class="fu">colnames</span>(DATOSM))</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Expandir datos para análisis por ojo</span></span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>DATOSM_all_eyes <span class="ot">&lt;-</span> Hiper1_eyes <span class="sc">%&gt;%</span></span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Edad =</span> Edad, <span class="st">`</span><span class="at">Ancho del NO</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del NO</span><span class="st">`</span>,</span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ancho del 3ro</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del 3ro</span><span class="st">`</span>,</span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Virchow Robin medida</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Virchow Robin medida</span><span class="st">`</span>,</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ancho del Meckel</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del Meckel</span><span class="st">`</span>,</span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Circunferencia del Meckel</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Circunferencia del Meckel</span><span class="st">`</span>,</span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Altura del Aracnoidocele</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Altura del Aracnoidocele</span><span class="st">`</span>,</span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Descenso tonsilar cuantitativo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Descenso tonsilar cuantitativo</span><span class="st">`</span>,</span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Espesor del TCS nucal</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Espesor del TCS nucal</span><span class="st">`</span>,</span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Distancia talamomesencefalica</span><span class="st">`</span>,</span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Atrio</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Atrio</span><span class="st">`</span>,</span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">VL frontal</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_VL frontal</span><span class="st">`</span>,</span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Tercer Ventriculo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Tercer Ventriculo</span><span class="st">`</span>,</span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>,</span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>,</span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a>         Frisen) <span class="sc">%&gt;%</span></span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Absent"</span>,<span class="st">"Present"</span>))</span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis comparativo usando todos los ojos</span></span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>TABLA3_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>vars_to_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Edad"</span>, <span class="st">"Ancho del NO"</span>, <span class="st">"Ancho del 3ro"</span>, <span class="st">"Virchow Robin medida"</span>,</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Ancho del Meckel"</span>, <span class="st">"Circunferencia del Meckel"</span>, </span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Altura del Aracnoidocele"</span>, <span class="st">"Descenso tonsilar cuantitativo"</span>,</span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Espesor del TCS nucal"</span>, <span class="st">"Distancia talamomesencefalica"</span>,</span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Atrio"</span>, <span class="st">"VL frontal"</span>, <span class="st">"Tercer Ventriculo"</span>, <span class="st">"Presión LCR"</span>)</span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> vars_to_test) {</span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a>  absent_data <span class="ot">&lt;-</span> DATOSM_all_eyes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Absent"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="sc">!!</span>var)</span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a>  mean_absent <span class="ot">&lt;-</span> <span class="fu">mean</span>(absent_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a>  sd_absent <span class="ot">&lt;-</span> <span class="fu">sd</span>(absent_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>  n_absent <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(absent_data))</span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>  absent_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_absent, sd_absent)</span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>  present_data <span class="ot">&lt;-</span> DATOSM_all_eyes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Present"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="sc">!!</span>var)</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a>  mean_present <span class="ot">&lt;-</span> <span class="fu">mean</span>(present_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>  sd_present <span class="ot">&lt;-</span> <span class="fu">sd</span>(present_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a>  n_present <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(present_data))</span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>  present_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_present, sd_present)</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n_absent <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> n_present <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a>    t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(absent_data, present_data)</span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>    w_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(absent_data, present_data)</span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a>    t_p <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, t_test<span class="sc">$</span>p.value)</span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a>    w_p <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, w_test<span class="sc">$</span>p.value)</span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>    t_p <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a>    w_p <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a>  TABLA3_rows[[<span class="fu">length</span>(TABLA3_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Absent (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> absent_stats,</span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Present (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> present_stats,</span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">n (Absent/Present)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d"</span>, n_absent, n_present),</span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (t-test)</span><span class="st">`</span> <span class="ot">=</span> t_p,</span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Wilcoxon)</span><span class="st">`</span> <span class="ot">=</span> w_p,</span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a>TABLA3_atrophy <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA3_rows)</span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 4: CORRELACIONES CON FRISEN (TODOS LOS OJOS)</span></span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>TABLA4_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> vars_to_test) {</span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a>  spear_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(DATOSM_all_eyes<span class="sc">$</span>Frisen), </span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a>                         DATOSM_all_eyes[[var]], </span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ya no necesitamos contar n_valid porque será fijo en el título</span></span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a>  TABLA4_rows[[<span class="fu">length</span>(TABLA4_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Spearman rho</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, spear_test<span class="sc">$</span>estimate),</span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, spear_test<span class="sc">$</span>p.value),</span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a>TABLA4_frisen <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA4_rows)</span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 5: VARIABLES CATEGÓRICAS CON ATROFIA (TODOS LOS OJOS)</span></span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos categóricos expandidos</span></span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a>DATOSM3_eyes <span class="ot">&lt;-</span> Hiper1_eyes <span class="sc">%&gt;%</span></span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Distención de vainas NO</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención de vainas NO</span><span class="st">`</span>, </span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aplanamiento posterior del globo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aplanamiento posterior del globo</span><span class="st">`</span>, </span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Protrusión del disco óptico</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Protrusión del disco óptico</span><span class="st">`</span>, </span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Realce del NO</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Realce del NO</span><span class="st">`</span>, </span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meckel prominente</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meckel prominente</span><span class="st">`</span>, </span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Distención III NC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención III NC</span><span class="st">`</span>, </span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Granulaciones Aracnoideas</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Granulaciones Aracnoideas</span><span class="st">`</span>, </span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meningocele</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningocele</span><span class="st">`</span>, </span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meningoencefalocele</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningoencefalocele</span><span class="st">`</span>, </span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aracnoidocele Selar</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aracnoidocele Selar</span><span class="st">`</span>, </span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span>, </span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Descenso tonsilar</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Descenso tonsilar</span><span class="st">`</span>, </span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Estenosis seno sigmoideo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Estenosis seno sigmoideo</span><span class="st">`</span>, </span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>))</span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Distención de vainas NO"</span>, <span class="st">"Aplanamiento posterior del globo"</span>,</span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Protrusión del disco óptico"</span>, <span class="st">"Realce del NO"</span>, <span class="st">"Meckel prominente"</span>,</span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Distención III NC"</span>, <span class="st">"Granulaciones Aracnoideas"</span>, <span class="st">"Meningocele"</span>,</span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Meningoencefalocele"</span>, <span class="st">"Aracnoidocele Selar"</span>, <span class="st">"Silla turca amplia aracnoidocele expansivo"</span>,</span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Descenso tonsilar"</span>, <span class="st">"Estenosis seno sigmoideo"</span>)</span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a>TABLA5_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(DATOSM3_eyes[[var]], DATOSM3_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>)</span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(tbl) <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">&amp;&amp;</span> <span class="fu">ncol</span>(tbl) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a>    n_no_atrophy <span class="ot">&lt;-</span> tbl[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a>    total_no_atrophy <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl[,<span class="dv">2</span>])</span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a>    pct_no_atrophy <span class="ot">&lt;-</span> (n_no_atrophy <span class="sc">/</span> total_no_atrophy) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a>    no_atrophy_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d (%.1f)"</span>, n_no_atrophy, total_no_atrophy, pct_no_atrophy)</span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a>    n_atrophy <span class="ot">&lt;-</span> tbl[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a>    total_atrophy <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl[,<span class="dv">1</span>])</span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a>    pct_atrophy <span class="ot">&lt;-</span> (n_atrophy <span class="sc">/</span> total_atrophy) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a>    atrophy_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d (%.1f)"</span>, n_atrophy, total_atrophy, pct_atrophy)</span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a>    or_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">oddsratio.fisher</span>(tbl)))</span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a>    or_val <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>    or_lower <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a>    or_upper <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a>    or_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f (%.2f-%.2f)"</span>, or_val, or_lower, or_upper)</span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> or_result<span class="sc">$</span>p.value[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a>    no_atrophy_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a>    atrophy_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a>    or_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a>  TABLA5_rows[[<span class="fu">length</span>(TABLA5_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">No Atrophy n/N (%)</span><span class="st">`</span> <span class="ot">=</span> no_atrophy_stats,</span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Atrophy n/N (%)</span><span class="st">`</span> <span class="ot">=</span> atrophy_stats,</span>
<span id="cb1-792"><a href="#cb1-792" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> or_stats,</span>
<span id="cb1-793"><a href="#cb1-793" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(p_val), <span class="st">"NA"</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_val)),</span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a>TABLA5_cat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA5_rows)</span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 6: REGRESIÓN LOGÍSTICA (TODOS LOS OJOS)</span></span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-805"><a href="#cb1-805" aria-hidden="true" tabindex="-1"></a>m_all_eyes <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">~</span> Edad <span class="sc">+</span> <span class="st">`</span><span class="at">Ancho del 3ro</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb1-806"><a href="#cb1-806" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>, </span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> DATOSM_all_eyes, <span class="at">family =</span> binomial)</span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_all_eyes)</span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">2</span>]</span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a>z_vals <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">3</span>]</span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>]</span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a>or_vals <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs)</span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">exp</span>(<span class="fu">confint</span>(m_all_eyes)))</span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a>TABLA6_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-817"><a href="#cb1-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-818"><a href="#cb1-818" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(coefs)) {</span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">names</span>(coefs)[i])</span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a>  TABLA6_rows[[<span class="fu">length</span>(TABLA6_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beta (SE)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f)"</span>, coefs[i], se[i]),</span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, or_vals[i], conf_int[i,<span class="dv">1</span>], conf_int[i,<span class="dv">2</span>]),</span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">z value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, z_vals[i]),</span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_vals[i]),</span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-832"><a href="#cb1-832" aria-hidden="true" tabindex="-1"></a>TABLA6_regression <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA6_rows)</span>
<span id="cb1-833"><a href="#cb1-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 7: CURVAS ROC (TODOS LOS OJOS)</span></span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a>roc_csf <span class="ot">&lt;-</span> <span class="fu">roc</span>(DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>, </span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a>               <span class="at">auc=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a>roc_thalamo <span class="ot">&lt;-</span> <span class="fu">roc</span>(DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span>, </span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a>                   <span class="at">auc=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-842"><a href="#cb1-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-843"><a href="#cb1-843" aria-hidden="true" tabindex="-1"></a>coords_csf <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_csf, <span class="st">"best"</span>)</span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a>coords_thalamo <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_thalamo, <span class="st">"best"</span>)</span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a>TABLA7_roc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"CSF Pressure"</span>, <span class="st">"Thalamo-mesencephalic distance"</span>),</span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">AUC (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, roc_csf<span class="sc">$</span>auc, roc_csf<span class="sc">$</span>ci[<span class="dv">1</span>], roc_csf<span class="sc">$</span>ci[<span class="dv">3</span>]),</span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, roc_thalamo<span class="sc">$</span>auc, roc_thalamo<span class="sc">$</span>ci[<span class="dv">1</span>], roc_thalamo<span class="sc">$</span>ci[<span class="dv">3</span>])</span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Optimal Cutoff</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, coords_csf<span class="sc">$</span>threshold),</span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, coords_thalamo<span class="sc">$</span>threshold)</span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Sensitivity/Specificity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f/%.1f"</span>, coords_csf<span class="sc">$</span>sensitivity<span class="sc">*</span><span class="dv">100</span>, coords_csf<span class="sc">$</span>specificity<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f/%.1f"</span>, coords_thalamo<span class="sc">$</span>sensitivity<span class="sc">*</span><span class="dv">100</span>, coords_thalamo<span class="sc">$</span>specificity<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR DATATABLES INTERACTIVAS</span></span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataTable interactiva</span></span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a>dt0 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA0_BASELINE,</span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 0: Complete Baseline Characteristics of Study Sample"</span>,</span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">50</span></span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 1: Variables continuas Pre-Post</span></span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA1,</span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 1: Pre-Post Analysis of Continuous Variables (Patient-level)"</span>,</span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 2: Variables categóricas Pre-Post</span></span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA2,</span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 2: Pre-Post Analysis of Categorical Variables (Patient-level)"</span>,</span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-905"><a href="#cb1-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-906"><a href="#cb1-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 3: Análisis de atrofia</span></span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a>dt3 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA3_atrophy,</span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 3: Continuous Variables by ON Atrophy Status (All Eyes as Units)"</span>,</span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-922"><a href="#cb1-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-923"><a href="#cb1-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-924"><a href="#cb1-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb1-925"><a href="#cb1-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb1-926"><a href="#cb1-926" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-927"><a href="#cb1-927" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-928"><a href="#cb1-928" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-929"><a href="#cb1-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb1-930"><a href="#cb1-930" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-931"><a href="#cb1-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-932"><a href="#cb1-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataTable con n=42 en el título</span></span>
<span id="cb1-933"><a href="#cb1-933" aria-hidden="true" tabindex="-1"></a>dt4 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA4_frisen,</span>
<span id="cb1-934"><a href="#cb1-934" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 4: Spearman Correlations with Frisen Grade (All Eyes, n=42)"</span>,  <span class="co"># n=42 en el título</span></span>
<span id="cb1-935"><a href="#cb1-935" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb1-936"><a href="#cb1-936" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-937"><a href="#cb1-937" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-938"><a href="#cb1-938" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-939"><a href="#cb1-939" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb1-940"><a href="#cb1-940" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-941"><a href="#cb1-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-942"><a href="#cb1-942" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-943"><a href="#cb1-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">3</span>,  <span class="co"># Ahora la columna p-value es la 3 en lugar de la 4</span></span>
<span id="cb1-944"><a href="#cb1-944" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-945"><a href="#cb1-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-946"><a href="#cb1-946" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 5: Variables categóricas con atrofia</span></span>
<span id="cb1-947"><a href="#cb1-947" aria-hidden="true" tabindex="-1"></a>dt5 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA5_cat,</span>
<span id="cb1-948"><a href="#cb1-948" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 5: Categorical Variables by ON Atrophy Status (All Eyes as Units)"</span>,</span>
<span id="cb1-949"><a href="#cb1-949" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb1-950"><a href="#cb1-950" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-951"><a href="#cb1-951" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-952"><a href="#cb1-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-953"><a href="#cb1-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-954"><a href="#cb1-954" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb1-955"><a href="#cb1-955" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb1-956"><a href="#cb1-956" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-957"><a href="#cb1-957" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-958"><a href="#cb1-958" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-959"><a href="#cb1-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb1-960"><a href="#cb1-960" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-961"><a href="#cb1-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-962"><a href="#cb1-962" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 6: Regresión logística</span></span>
<span id="cb1-963"><a href="#cb1-963" aria-hidden="true" tabindex="-1"></a>dt6 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA6_regression,</span>
<span id="cb1-964"><a href="#cb1-964" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 6: Logistic Regression Model for ON Atrophy (All Eyes as Units)"</span>,</span>
<span id="cb1-965"><a href="#cb1-965" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb1-966"><a href="#cb1-966" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-967"><a href="#cb1-967" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-968"><a href="#cb1-968" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-969"><a href="#cb1-969" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span></span>
<span id="cb1-970"><a href="#cb1-970" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-971"><a href="#cb1-971" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-972"><a href="#cb1-972" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-973"><a href="#cb1-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb1-974"><a href="#cb1-974" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb1-975"><a href="#cb1-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-976"><a href="#cb1-976" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 7: Análisis ROC</span></span>
<span id="cb1-977"><a href="#cb1-977" aria-hidden="true" tabindex="-1"></a>dt7 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA7_roc,</span>
<span id="cb1-978"><a href="#cb1-978" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 7: ROC Curve Analysis for ON Atrophy Prediction (All Eyes as Units)"</span>,</span>
<span id="cb1-979"><a href="#cb1-979" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb1-980"><a href="#cb1-980" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb1-981"><a href="#cb1-981" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb1-982"><a href="#cb1-982" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb1-983"><a href="#cb1-983" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span></span>
<span id="cb1-984"><a href="#cb1-984" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-985"><a href="#cb1-985" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb1-986"><a href="#cb1-986" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-987"><a href="#cb1-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-988"><a href="#cb1-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar tablas</span></span>
<span id="cb1-989"><a href="#cb1-989" aria-hidden="true" tabindex="-1"></a>dt0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-43a952ed07e7ff1bfc93" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-43a952ed07e7ff1bfc93">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 0: Complete Baseline Characteristics of Study Sample<\/caption>","data":[["Age (years)","Sex (Female)","CSF Pressure (cmH2O)","Time without ACTZ (days)","ON width (mm)","Virchow Robin measurement (mm)","Meckel width (mm)","Meckel circumference (mm)","3rd ventricle width (mm)","Arachnoidocele height (mm)","Tonsillar descent (mm)","Nuchal SCT thickness (mm)","Thalamo-mesencephalic distance (mm)","Atrium (mm)","Frontal VL (mm)","Third Ventricle (mm)","ON atrophy OD","ON atrophy OI","Frisen Grade OD","Frisen Grade OI","Chronic headache","Other surgery","ON sheath distention","CN III distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","Meckel shape","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica","Tonsillar descent (categorical)","Sigmoid sinus stenosis"],["24.38 ± 10.01","15 (71.4)","37.33 ± 8.62","36.81 ± 28.95","6.35 ± 1.26","1.81 ± 0.73","3.57 ± 1.42","28.65 ± 6.89","2.73 ± 1.22","3.84 ± 2.14","0.13 ± 0.61","13.20 ± 4.77","3.33 ± 1.54","10.15 ± 2.09","4.15 ± 1.51","3.66 ± 0.89","7 (33.3)","7 (33.3)","1: 5 (23.8); 2: 2 (9.5); 3: 3 (14.3); 4: 3 (14.3); 5: 8 (38.1)","1: 4 (19.0); 2: 3 (14.3); 3: 4 (19.0); 4: 2 (9.5); 5: 8 (38.1)","6 (28.6)","0 (0.0)","18 (85.7)","8 (38.1)","16 (76.2)","14 (66.7)","11 (52.4)","1 (4.8)","Type1: 1 (4.8); Type2: 20 (95.2); Type3: 0 (0.0)","1 (4.8)","1 (4.8)","0 (0.0)","18 (85.7)","4 (19.0)","1 (4.8)","17 (85.0)"],["21.00 ± 7.48","4 (50.0)","37.75 ± 10.63","40.62 ± 35.52","6.94 ± 1.12","1.76 ± 0.73","3.21 ± 1.02","27.70 ± 5.27","3.01 ± 1.12","3.71 ± 2.28","0.35 ± 0.99","13.95 ± 6.40","2.99 ± 1.25","9.49 ± 2.04","4.06 ± 1.36","3.99 ± 0.66","4 (50.0)","3 (37.5)","1: 1 (12.5); 2: 0 (0.0); 3: 0 (0.0); 4: 2 (25.0); 5: 5 (62.5)","1: 1 (12.5); 2: 0 (0.0); 3: 1 (12.5); 4: 1 (12.5); 5: 5 (62.5)","2 (25.0)","0 (0.0)","7 (87.5)","4 (50.0)","7 (87.5)","6 (75.0)","4 (50.0)","0 (0.0)","Type1: 0 (0.0); Type2: 8 (100.0); Type3: 0 (0.0)","1 (12.5)","1 (12.5)","0 (0.0)","7 (87.5)","2 (25.0)","1 (12.5)","7 (87.5)"],["26.46 ± 11.04","11 (84.6)","37.08 ± 7.60","34.46 ± 25.39","5.99 ± 1.24","1.85 ± 0.76","3.79 ± 1.62","29.23 ± 7.87","2.56 ± 1.29","3.92 ± 2.14","0.00 ± 0.00","12.73 ± 3.67","3.54 ± 1.71","10.55 ± 2.09","4.20 ± 1.65","3.45 ± 0.98","3 (23.1)","4 (30.8)","1: 4 (30.8); 2: 2 (15.4); 3: 3 (23.1); 4: 1 (7.7); 5: 3 (23.1)","1: 3 (23.1); 2: 3 (23.1); 3: 3 (23.1); 4: 1 (7.7); 5: 3 (23.1)","4 (30.8)","0 (0.0)","11 (84.6)","4 (30.8)","9 (69.2)","8 (61.5)","7 (53.8)","1 (7.7)","Type1: 1 (7.7); Type2: 12 (92.3); Type3: 0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","11 (84.6)","2 (15.4)","0 (0.0)","10 (83.3)"],["0.193","0.146","0.879","0.677","0.090","0.788","0.322","0.600","0.410","0.837","0.351","0.634","0.407","0.267","0.838","0.154","0.346","1.000","0.046","0.071","1.000","1.000","1.000","0.646","0.606","0.656","1.000","1.000","1.000","0.381","0.381","1.000","1.000","0.618","0.381","1.000"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Overall (n=21)<\/th>\n      <th>With Valve (n=8)<\/th>\n      <th>Without Valve (n=13)<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":50,"columnDefs":[{"name":"Variable","targets":0},{"name":"Overall (n=21)","targets":1},{"name":"With Valve (n=8)","targets":2},{"name":"Without Valve (n=13)","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dt1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ccd4a918dbbc4c56d6fe" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ccd4a918dbbc4c56d6fe">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 1: Pre-Post Analysis of Continuous Variables (Patient-level)<\/caption>","data":[["ON width","Virchow Robin measurement","Meckel width","Meckel circumference","3rd ventricle width","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle"],["6.35 ± 1.26","1.81 ± 0.73","3.57 ± 1.42","28.65 ± 6.89","2.73 ± 1.22","3.84 ± 2.14","0.13 ± 0.61","13.20 ± 4.77","3.33 ± 1.54","10.15 ± 2.09","4.15 ± 1.51","3.66 ± 0.89"],["4.90 ± 1.30","2.02 ± 0.66","4.74 ± 1.58","30.80 ± 10.45","3.39 ± 1.47","3.18 ± 2.78","0.14 ± 0.63","13.41 ± 4.73","3.01 ± 1.47","10.00 ± 2.31","3.93 ± 1.32","3.61 ± 0.93"],["0.0001","0.1544","0.0006","0.1552","0.0452","0.1744","0.3293","0.8038","0.1062","0.4883","0.2416","0.7598"],["4.28 ± 0.96","1.70 ± 0.75","4.15 ± 0.82","26.20 ± 3.98","2.64 ± 1.38","2.00 ± 2.95","0.36 ± 1.03","13.35 ± 5.01","2.38 ± 1.38","9.16 ± 2.53","3.88 ± 1.11","3.33 ± 0.62"],["5.28 ± 1.37","2.22 ± 0.53","5.11 ± 1.85","33.64 ± 12.25","3.85 ± 1.37","3.90 ± 2.51","0.00 ± 0.00","13.45 ± 4.75","3.40 ± 1.44","10.52 ± 2.09","3.97 ± 1.48","3.78 ± 1.06"],["0.0032","0.0548","0.3366","0.0592","0.0084","0.0760","0.5945","0.5935","0.1120","0.5121","0.9830","0.0012"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>T1 (Mean ± SD)<\/th>\n      <th>T2 (Mean ± SD)<\/th>\n      <th>p value (Paired t)<\/th>\n      <th>T2 with Valve<\/th>\n      <th>T2 without Valve<\/th>\n      <th>p value (ANCOVA)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"T1 (Mean ± SD)","targets":1},{"name":"T2 (Mean ± SD)","targets":2},{"name":"p value (Paired t)","targets":3},{"name":"T2 with Valve","targets":4},{"name":"T2 without Valve","targets":5},{"name":"p value (ANCOVA)","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0339d37d91417d4295ed" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0339d37d91417d4295ed">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 2: Pre-Post Analysis of Categorical Variables (Patient-level)<\/caption>","data":[["ON sheath distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","CN III distention","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica with expansive arachnoidocele","Tonsillar descent","Sigmoid sinus stenosis"],["18 (85.7)","16 (76.2)","14 (66.7)","11 (52.4)","1 (4.8)","8 (38.1)","1 (4.8)","1 (4.8)","0 (0.0)","18 (85.7)","4 (19.0)","1 (4.8)","17 (85.0)"],["6 (28.6)","5 (23.8)","0 (0.0)","0 (0.0)","3 (14.3)","5 (23.8)","3 (14.3)","1 (4.8)","1 (4.8)","15 (71.4)","7 (33.3)","1 (4.8)","10 (47.6)"],["0.0015","0.0026","0.0005","0.0026","0.4795","0.3711","0.4795","1.0000","1.0000","0.3711","0.4497","NaN","0.0133"],["2 (25.0)","2 (25.0)","0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","1 (12.5)","0 (0.0)","0 (0.0)","3 (37.5)","2 (25.0)","1 (12.5)","2 (25.0)"],["4 (30.8)","3 (23.1)","0 (0.0)","0 (0.0)","3 (23.1)","5 (38.5)","2 (15.4)","1 (7.7)","1 (7.7)","12 (92.3)","5 (38.5)","0 (0.0)","8 (61.5)"],["1.0000","1.0000","NaN","NaN","0.4091","0.1383","1.0000","1.0000","1.0000","0.0276","0.8738","0.8017","0.2387"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>T1 n (%)<\/th>\n      <th>T2 n (%)<\/th>\n      <th>p value (McNemar)<\/th>\n      <th>T2 with Valve n (%)<\/th>\n      <th>T2 without Valve n (%)<\/th>\n      <th>p value (Chi-square)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"T1 n (%)","targets":1},{"name":"T2 n (%)","targets":2},{"name":"p value (McNemar)","targets":3},{"name":"T2 with Valve n (%)","targets":4},{"name":"T2 without Valve n (%)","targets":5},{"name":"p value (Chi-square)","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dt3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c6f2201b3ae1ad45ae3c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c6f2201b3ae1ad45ae3c">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 3: Continuous Variables by ON Atrophy Status (All Eyes as Units)<\/caption>","data":[["Age","ON width","3rd ventricle width","Virchow Robin measurement","Meckel width","Meckel circumference","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle","CSF Pressure"],["24.21 ± 9.21","6.41 ± 1.27","2.60 ± 1.30","1.84 ± 0.66","3.71 ± 1.61","29.59 ± 7.98","3.54 ± 1.81","0.00 ± 0.00","12.70 ± 4.08","3.06 ± 1.47","10.74 ± 2.07","4.36 ± 1.47","3.58 ± 0.90","36.29 ± 6.56"],["24.71 ± 11.47","6.24 ± 1.22","3.01 ± 0.99","1.76 ± 0.86","3.29 ± 0.87","26.76 ± 2.81","4.43 ± 2.58","0.40 ± 1.02","14.18 ± 5.83","3.86 ± 1.54","8.96 ± 1.50","3.72 ± 1.50","3.82 ± 0.85","39.43 ± 11.51"],["28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14","28/14"],["0.8885","0.6888","0.2625","0.7838","0.2730","0.1006","0.2626","0.1648","0.4066","0.1236","0.0032","0.2008","0.3939","0.3562"],["0.8411","0.9893","0.4305","0.5124","0.3150","0.2437","0.1684","0.0467","0.4456","0.0466","0.0180","0.0383","0.6592","0.7179"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Absent (Mean ± SD)<\/th>\n      <th>Present (Mean ± SD)<\/th>\n      <th>n (Absent/Present)<\/th>\n      <th>p value (t-test)<\/th>\n      <th>p value (Wilcoxon)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"Absent (Mean ± SD)","targets":1},{"name":"Present (Mean ± SD)","targets":2},{"name":"n (Absent/Present)","targets":3},{"name":"p value (t-test)","targets":4},{"name":"p value (Wilcoxon)","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dt4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f45854861b3bc8c4bd41" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f45854861b3bc8c4bd41">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 4: Spearman Correlations with Frisen Grade (All Eyes, n=42)<\/caption>","data":[["Age","ON width","3rd ventricle width","Virchow Robin measurement","Meckel width","Meckel circumference","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle","CSF Pressure"],["-0.459","0.246","-0.256","-0.223","-0.418","-0.265","-0.165","0.249","-0.070","0.510","-0.050","0.045","0.218","0.299"],["0.0022","0.1162","0.1020","0.1552","0.0058","0.0896","0.2949","0.1117","0.6593","0.0006","0.7544","0.7796","0.1662","0.0542"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Spearman rho<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"Spearman rho","targets":1},{"name":"p value","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dt5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ba19422cf8c395858363" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ba19422cf8c395858363">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 5: Categorical Variables by ON Atrophy Status (All Eyes as Units)<\/caption>","data":[["ON sheath distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","CN III distention","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica with expansive arachnoidocele","Tonsillar descent","Sigmoid sinus stenosis"],["24/28 (85.7)","20/28 (71.4)","16/28 (57.1)","14/28 (50.0)","2/28 (7.1)","12/28 (42.9)","2/28 (7.1)","2/28 (7.1)","0/28 (0.0)","24/28 (85.7)","4/28 (14.3)","0/28 (0.0)","25/28 (89.3)"],["12/14 (85.7)","12/14 (85.7)","12/14 (85.7)","8/14 (57.1)","0/14 (0.0)","4/14 (28.6)","0/14 (0.0)","0/14 (0.0)","0/14 (0.0)","12/14 (85.7)","4/14 (28.6)","2/14 (14.3)","9/12 (75.0)"],["1.00 (0.12-12.53)","2.35 (0.38-26.39)","4.35 (0.74-47.32)","1.32 (0.31-5.99)","0.00 (0.00-10.76)","0.54 (0.10-2.49)","0.00 (0.00-10.76)","0.00 (0.00-10.76)","0.00 (0.00-Inf)","1.00 (0.12-12.53)","2.35 (0.36-15.44)","Inf (0.39-Inf)","0.37 (0.04-3.28)"],["1.0000","0.4508","0.0886","0.7499","0.5447","0.5051","0.5447","0.5447","1.0000","1.0000","0.4064","0.1057","0.3407"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>No Atrophy n/N (%)<\/th>\n      <th>Atrophy n/N (%)<\/th>\n      <th>OR (95% CI)<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"No Atrophy n/N (%)","targets":1},{"name":"Atrophy n/N (%)","targets":2},{"name":"OR (95% CI)","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dt6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-149d57904df103b6f8a9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-149d57904df103b6f8a9">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 6: Logistic Regression Model for ON Atrophy (All Eyes as Units)<\/caption>","data":[["(Intercept)","Age","`3rd ventricle width`","`Thalamo-mesencephalic distance`","`CSF Pressure`"],["-11.985 (4.395)","0.102 (0.055)","1.003 (0.421)","0.953 (0.394)","0.071 (0.056)"],["0.000 (0.000-0.012)","1.107 (1.002-1.250)","2.727 (1.288-6.972)","2.593 (1.306-6.524)","1.073 (0.968-1.215)"],["-2.727","1.864","2.386","2.420","1.267"],["0.0064","0.0623","0.0171","0.0155","0.2051"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Beta (SE)<\/th>\n      <th>OR (95% CI)<\/th>\n      <th>z value<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":10,"columnDefs":[{"name":"Variable","targets":0},{"name":"Beta (SE)","targets":1},{"name":"OR (95% CI)","targets":2},{"name":"z value","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dt7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-6f6e663fb519de795998" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6f6e663fb519de795998">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 7: ROC Curve Analysis for ON Atrophy Prediction (All Eyes as Units)<\/caption>","data":[["CSF Pressure","Thalamo-mesencephalic distance"],["0.464 (0.242-0.687)","0.691 (0.493-0.890)"],["28.5","3.8"],["21.4/96.4","71.4/85.7"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>AUC (95% CI)<\/th>\n      <th>Optimal Cutoff<\/th>\n      <th>Sensitivity/Specificity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":10,"columnDefs":[{"name":"Variable","targets":0},{"name":"AUC (95% CI)","targets":1},{"name":"Optimal Cutoff","targets":2},{"name":"Sensitivity/Specificity","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR FIGURAS</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURA 1 CORREGIDA - USANDO DIRECTAMENTE DATOS DE TABLA 1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Primero, vamos a recrear la Tabla 1 para tener los valores exactos</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># y luego usarlos directamente para la figura</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 1: Recalcular Tabla 1 para asegurar consistencia</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>HiperOrd <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">49</span><span class="sc">:</span><span class="dv">52</span>,<span class="dv">55</span><span class="sc">:</span><span class="dv">58</span>,<span class="dv">59</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">61</span><span class="sc">:</span><span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>,<span class="dv">71</span>)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir a numérico</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>cols_to_check <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">26</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> cols_to_check) {</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  HiperOrd[,col] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[col]])</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar válvula derivativa</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 2: Crear dataframe para gráfico directamente desde los cálculos</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables a incluir (índices de columnas en pares)</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>var_pairs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>var_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ON width"</span>, <span class="st">"Virchow Robin measurement"</span>, <span class="st">"Meckel width"</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Meckel circumference"</span>, <span class="st">"3rd ventricle width"</span>, <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Quantitative tonsillar descent"</span>, <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Thalamo-mesencephalic distance"</span>, <span class="st">"Atrium"</span>, <span class="st">"Frontal VL"</span>, <span class="st">"Third Ventricle"</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var_pairs)) {</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> var_pairs[i]</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T1 - Overall</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  vals_t1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[idx]])</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  mean_t1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  sd_t1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  n_t1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1))</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  se_t1 <span class="ot">&lt;-</span> sd_t1<span class="sc">/</span><span class="fu">sqrt</span>(n_t1)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - Overall</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  vals_t2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[idx<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  mean_t2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  sd_t2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  n_t2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  se_t2 <span class="ot">&lt;-</span> sd_t2<span class="sc">/</span><span class="fu">sqrt</span>(n_t2)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - With Valve</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  vals_t2_valve <span class="ot">&lt;-</span> vals_t2[valve_mask]</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  mean_t2_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  sd_t2_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  n_t2_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2_valve))</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  se_t2_valve <span class="ot">&lt;-</span> sd_t2_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t2_valve)</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - Without Valve</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  no_valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  vals_t2_no_valve <span class="ot">&lt;-</span> vals_t2[no_valve_mask]</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  mean_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  sd_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>  n_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2_no_valve))</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  se_t2_no_valve <span class="ot">&lt;-</span> sd_t2_no_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t2_no_valve)</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Para el gráfico, necesitamos T1 y T2 para cada grupo</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Asumiendo que T1 es igual para ambos grupos (pre-tratamiento)</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Necesitamos T1 para cada grupo</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  vals_t1_valve <span class="ot">&lt;-</span> vals_t1[valve_mask]</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  mean_t1_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  sd_t1_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  n_t1_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1_valve))</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  se_t1_valve <span class="ot">&lt;-</span> sd_t1_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t1_valve)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  vals_t1_no_valve <span class="ot">&lt;-</span> vals_t1[no_valve_mask]</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  mean_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>  sd_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  n_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1_no_valve))</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>  se_t1_no_valve <span class="ot">&lt;-</span> sd_t1_no_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t1_no_valve)</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agregar datos al dataframe</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grupo con válvula</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot_data,</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Surgical Treatment"</span>,</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Pre"</span>,</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t1_valve,</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t1_valve,</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t1_valve,</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t1_valve</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Surgical Treatment"</span>,</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Post"</span>,</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t2_valve,</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t2_valve,</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t2_valve,</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t2_valve</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grupo sin válvula</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Medical Treatment"</span>,</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Pre"</span>,</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t1_no_valve,</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t1_no_valve,</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t1_no_valve,</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t1_no_valve</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Medical Treatment"</span>,</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Post"</span>,</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t2_no_valve,</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t2_no_valve,</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t2_no_valve,</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t2_no_valve</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular intervalos de confianza al 95%</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>CI_lower <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>Mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> plot_data<span class="sc">$</span>SE</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>CI_upper <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>Mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> plot_data<span class="sc">$</span>SE</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar variables para el gráfico</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_data<span class="sc">$</span>Time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>))</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_data<span class="sc">$</span>Treatment, </span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span>, <span class="st">"Medical Treatment"</span>))</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 4: Crear la figura con los valores correctos</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables seleccionadas para mostrar</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ON width"</span>, <span class="st">"3rd ventricle width"</span>, <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Quantitative tonsillar descent"</span>, <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Thalamo-mesencephalic distance"</span>, <span class="st">"Atrium"</span>, <span class="st">"Third Ventricle"</span>)</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span> </span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Variable <span class="sc">%in%</span> selected_vars) <span class="sc">%&gt;%</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment, </span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> Treatment, <span class="at">shape =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), </span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="st">"grey50"</span>)) <span class="sc">+</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="st">"solid"</span>, </span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="st">"longdash"</span>)) <span class="sc">+</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="dv">16</span>, </span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean ± 95% CI (mm)"</span>) <span class="sc">+</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolution of MRI Parameters by Treatment Group"</span>,</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Pre-Post Comparison with 95% Confidence Intervals"</span></span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar figura</span></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.png"</span>, p1, </span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">device =</span> <span class="st">'png'</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 2: Boxplots para atrofia del NO (todos los ojos)</span></span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a>compara_pares <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Absent"</span>, <span class="st">"Present"</span>))</span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>fig2a <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Descenso tonsilar cuantitativo"</span>,</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Quantitative tonsillar descent (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-199"><a href="#cb9-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>fig2b <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Distancia talamomesencefalica"</span>,</span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb9-211"><a href="#cb9-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Thalamo-mesencephalic distance (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb9-212"><a href="#cb9-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a>fig2c <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Presión LCR"</span>,</span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"t.test"</span>) <span class="sc">+</span> </span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"CSF Pressure (cmH2O)"</span>) <span class="sc">+</span> </span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a>fig2d <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb9-230"><a href="#cb9-230" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-231"><a href="#cb9-231" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Atrio"</span>,</span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb9-236"><a href="#cb9-236" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb9-237"><a href="#cb9-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Atrium (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-243"><a href="#cb9-243" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig2a, fig2b, fig2c, fig2d, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb9-244"><a href="#cb9-244" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure2.png"</span>, p2, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, </span>
<span id="cb9-245"><a href="#cb9-245" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>)</span>
<span id="cb9-246"><a href="#cb9-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-247"><a href="#cb9-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 3: Curvas ROC</span></span>
<span id="cb9-248"><a href="#cb9-248" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-249"><a href="#cb9-249" aria-hidden="true" tabindex="-1"></a>roc_csf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-250"><a href="#cb9-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensitivity =</span> roc_csf<span class="sc">$</span>sensitivities,</span>
<span id="cb9-251"><a href="#cb9-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">specificity =</span> roc_csf<span class="sc">$</span>specificities,</span>
<span id="cb9-252"><a href="#cb9-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_csf<span class="sc">$</span>specificities</span>
<span id="cb9-253"><a href="#cb9-253" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-254"><a href="#cb9-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-255"><a href="#cb9-255" aria-hidden="true" tabindex="-1"></a>roc_thalamo_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-256"><a href="#cb9-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensitivity =</span> roc_thalamo<span class="sc">$</span>sensitivities,</span>
<span id="cb9-257"><a href="#cb9-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">specificity =</span> roc_thalamo<span class="sc">$</span>specificities,</span>
<span id="cb9-258"><a href="#cb9-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_thalamo<span class="sc">$</span>specificities</span>
<span id="cb9-259"><a href="#cb9-259" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-260"><a href="#cb9-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-261"><a href="#cb9-261" aria-hidden="true" tabindex="-1"></a>optimal_csf <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_csf, <span class="st">"best"</span>)</span>
<span id="cb9-262"><a href="#cb9-262" aria-hidden="true" tabindex="-1"></a>optimal_thalamo <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_thalamo, <span class="st">"best"</span>)</span>
<span id="cb9-263"><a href="#cb9-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-264"><a href="#cb9-264" aria-hidden="true" tabindex="-1"></a>fig3a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_csf_df, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb9-265"><a href="#cb9-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-266"><a href="#cb9-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb9-267"><a href="#cb9-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> optimal_csf<span class="sc">$</span>specificity, <span class="at">y =</span> optimal_csf<span class="sc">$</span>sensitivity),</span>
<span id="cb9-268"><a href="#cb9-268" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb9-269"><a href="#cb9-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb9-270"><a href="#cb9-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(roc_csf<span class="sc">$</span>auc, <span class="dv">3</span>),</span>
<span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">CI: "</span>, <span class="fu">round</span>(roc_csf<span class="sc">$</span>ci[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>, </span>
<span id="cb9-272"><a href="#cb9-272" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc_csf<span class="sc">$</span>ci[<span class="dv">3</span>], <span class="dv">3</span>),</span>
<span id="cb9-273"><a href="#cb9-273" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">Optimal cutoff: "</span>, <span class="fu">round</span>(optimal_csf<span class="sc">$</span>threshold, <span class="dv">2</span>)),</span>
<span id="cb9-274"><a href="#cb9-274" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-275"><a href="#cb9-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve: CSF Pressure for ON Atrophy Prediction"</span>,</span>
<span id="cb9-276"><a href="#cb9-276" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span id="cb9-277"><a href="#cb9-277" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb9-278"><a href="#cb9-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-279"><a href="#cb9-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-280"><a href="#cb9-280" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb9-281"><a href="#cb9-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb9-282"><a href="#cb9-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-283"><a href="#cb9-283" aria-hidden="true" tabindex="-1"></a>fig3b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_thalamo_df, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb9-284"><a href="#cb9-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-285"><a href="#cb9-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb9-286"><a href="#cb9-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> optimal_thalamo<span class="sc">$</span>specificity, <span class="at">y =</span> optimal_thalamo<span class="sc">$</span>sensitivity),</span>
<span id="cb9-287"><a href="#cb9-287" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb9-288"><a href="#cb9-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb9-289"><a href="#cb9-289" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>auc, <span class="dv">3</span>),</span>
<span id="cb9-290"><a href="#cb9-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">CI: "</span>, <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>ci[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>, </span>
<span id="cb9-291"><a href="#cb9-291" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>ci[<span class="dv">3</span>], <span class="dv">3</span>),</span>
<span id="cb9-292"><a href="#cb9-292" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">Optimal cutoff: "</span>, <span class="fu">round</span>(optimal_thalamo<span class="sc">$</span>threshold, <span class="dv">2</span>)),</span>
<span id="cb9-293"><a href="#cb9-293" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-294"><a href="#cb9-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve: Thalamo-mesencephalic Distance for ON Atrophy Prediction"</span>,</span>
<span id="cb9-295"><a href="#cb9-295" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span id="cb9-296"><a href="#cb9-296" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb9-297"><a href="#cb9-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-298"><a href="#cb9-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-299"><a href="#cb9-299" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb9-300"><a href="#cb9-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb9-301"><a href="#cb9-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-302"><a href="#cb9-302" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig3a, fig3b, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb9-303"><a href="#cb9-303" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure3.png"</span>, p3, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">5</span>, </span>
<span id="cb9-304"><a href="#cb9-304" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb9-305"><a href="#cb9-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-306"><a href="#cb9-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 4: Correlaciones con Grado Frisen (todos los ojos)</span></span>
<span id="cb9-307"><a href="#cb9-307" aria-hidden="true" tabindex="-1"></a>DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Frisen n</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(DATOSM_all_eyes<span class="sc">$</span>Frisen)</span>
<span id="cb9-308"><a href="#cb9-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-309"><a href="#cb9-309" aria-hidden="true" tabindex="-1"></a>fig4a <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Presión LCR"</span>, </span>
<span id="cb9-310"><a href="#cb9-310" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb9-312"><a href="#cb9-312" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"CSF Pressure (cmH2O)"</span>) <span class="sc">+</span></span>
<span id="cb9-313"><a href="#cb9-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-314"><a href="#cb9-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-315"><a href="#cb9-315" aria-hidden="true" tabindex="-1"></a>fig4b <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Distancia talamomesencefalica"</span>, </span>
<span id="cb9-316"><a href="#cb9-316" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-317"><a href="#cb9-317" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb9-318"><a href="#cb9-318" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Thalamo-mesencephalic distance (mm)"</span>) <span class="sc">+</span></span>
<span id="cb9-319"><a href="#cb9-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-320"><a href="#cb9-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-321"><a href="#cb9-321" aria-hidden="true" tabindex="-1"></a>fig4c <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Edad"</span>, </span>
<span id="cb9-322"><a href="#cb9-322" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-323"><a href="#cb9-323" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb9-324"><a href="#cb9-324" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Age (years)"</span>) <span class="sc">+</span></span>
<span id="cb9-325"><a href="#cb9-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-326"><a href="#cb9-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-327"><a href="#cb9-327" aria-hidden="true" tabindex="-1"></a>fig4d <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Ancho del Meckel"</span>, </span>
<span id="cb9-328"><a href="#cb9-328" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-329"><a href="#cb9-329" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb9-330"><a href="#cb9-330" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Meckel width (mm)"</span>) <span class="sc">+</span></span>
<span id="cb9-331"><a href="#cb9-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-332"><a href="#cb9-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-333"><a href="#cb9-333" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig4a, fig4b, fig4c, fig4d, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb9-334"><a href="#cb9-334" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure4.png"</span>, p4, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, </span>
<span id="cb9-335"><a href="#cb9-335" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>)</span>
<span id="cb9-336"><a href="#cb9-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-337"><a href="#cb9-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar figuras</span></span>
<span id="cb9-338"><a href="#cb9-338" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="frisen-4-5" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Frisen 4-5</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CARGA Y PREPROCESAMIENTO DE DATOS</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para encontrar el directorio raíz del proyecto</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>project_root <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  qdir <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"QUARTO_PROJECT_DIR"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(qdir)) <span class="fu">return</span>(<span class="fu">normalizePath</span>(qdir, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">current_input</span>()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ci) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(ci) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">nzchar</span>(ci)) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(ci, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">dirname</span>(p)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">basename</span>(d) <span class="sc">==</span> <span class="st">"docs"</span>) <span class="fu">return</span>(<span class="fu">dirname</span>(d))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(d)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  od <span class="ot">&lt;-</span> knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">get</span>(<span class="st">"output.dir"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(od) <span class="sc">&amp;&amp;</span> <span class="fu">nzchar</span>(od)) {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    od <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(od, <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">basename</span>(od) <span class="sc">==</span> <span class="st">"docs"</span>) <span class="fu">return</span>(<span class="fu">dirname</span>(od))</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(od)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  cur <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="fu">getwd</span>(), <span class="at">winslash =</span> <span class="st">"/"</span>, <span class="at">mustWork =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dir.exists</span>(<span class="fu">file.path</span>(cur, <span class="st">"data"</span>))) <span class="fu">return</span>(cur)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    nxt <span class="ot">&lt;-</span> <span class="fu">dirname</span>(cur)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">identical</span>(nxt, cur)) <span class="cf">break</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    cur <span class="ot">&lt;-</span> nxt</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  cur</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>root_dir <span class="ot">&lt;-</span> <span class="fu">project_root</span>()</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(root_dir, <span class="st">"data"</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>find_data <span class="ot">&lt;-</span> <span class="cf">function</span>(pattern){</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">list.files</span>(data_dir, <span class="at">pattern =</span> pattern, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(f) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">"Archivo no encontrado: "</span>, pattern, <span class="st">" en "</span>, data_dir)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  f[[<span class="dv">1</span>]]</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar archivo de datos - Hipertensión 1</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>file_hiper1 <span class="ot">&lt;-</span> <span class="fu">find_data</span>(<span class="st">"Hipertensi[oó]n</span><span class="sc">\\</span><span class="st">.xlsx$|Hipertensi[oó]n1</span><span class="sc">\\</span><span class="st">.xlsx$"</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer la hoja "RM 1 y RM 2" con tipos de columnas específicos</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>col_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"text"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"date"</span>, <span class="dv">2</span>), <span class="st">"text"</span>, <span class="fu">rep</span>(<span class="st">"numeric"</span>, <span class="dv">65</span>), <span class="st">"text"</span>, <span class="st">"text"</span>)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>Hiper1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_hiper1, <span class="at">sheet =</span> <span class="st">"RM 1 y RM 2"</span>, <span class="at">col_types =</span> col_types)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Corregir nombres de columnas duplicadas</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Hiper1) <span class="ot">&lt;-</span> <span class="fu">make.unique</span>(<span class="fu">names</span>(Hiper1), <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co"># EXTRACCIÓN DEL SEXO A PARTIR DEL NOMBRE</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>extract_sex <span class="ot">&lt;-</span> <span class="cf">function</span>(names_vector) {</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  names_upper <span class="ot">&lt;-</span> <span class="fu">toupper</span>(<span class="fu">trimws</span>(names_vector))</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  male_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JUAN"</span>, <span class="st">"JOSE"</span>, <span class="st">"PEDRO"</span>, <span class="st">"CARLOS"</span>, <span class="st">"LUIS"</span>, <span class="st">"JORGE"</span>, <span class="st">"ALBERTO"</span>, </span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"FRANCISCO"</span>, <span class="st">"ANTONIO"</span>, <span class="st">"MIGUEL"</span>, <span class="st">"MANUEL"</span>, <span class="st">"FERNANDO"</span>, <span class="st">"SERGIO"</span>,</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"RICARDO"</span>, <span class="st">"EDUARDO"</span>, <span class="st">"MARIO"</span>, <span class="st">"ROBERTO"</span>, <span class="st">"DANIEL"</span>, <span class="st">"PABLO"</span>,</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"ALEJANDRO"</span>, <span class="st">"ANDRES"</span>, <span class="st">"DIEGO"</span>, <span class="st">"RAFAEL"</span>, <span class="st">"RAMON"</span>, <span class="st">"VICTOR"</span>,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"MARTIN"</span>, <span class="st">"RAUL"</span>, <span class="st">"OSCAR"</span>, <span class="st">"ALFONSO"</span>, <span class="st">"ARTURO"</span>, <span class="st">"ENRIQUE"</span>,</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"GERARDO"</span>, <span class="st">"HECTOR"</span>, <span class="st">"JAVIER"</span>, <span class="st">"JESUS"</span>, <span class="st">"MARCO"</span>, <span class="st">"OMAR"</span>)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>  female_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MARIA"</span>, <span class="st">"ANA"</span>, <span class="st">"LAURA"</span>, <span class="st">"PATRICIA"</span>, <span class="st">"CARMEN"</span>, <span class="st">"ROSA"</span>, <span class="st">"SOFIA"</span>,</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"GABRIELA"</span>, <span class="st">"ELENA"</span>, <span class="st">"MARTHA"</span>, <span class="st">"LUCIA"</span>, <span class="st">"ANDREA"</span>, <span class="st">"ADRIANA"</span>,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"MONICA"</span>, <span class="st">"TERESA"</span>, <span class="st">"CLAUDIA"</span>, <span class="st">"BEATRIZ"</span>, <span class="st">"SANDRA"</span>, <span class="st">"VERONICA"</span>,</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"ALEJANDRA"</span>, <span class="st">"LETICIA"</span>, <span class="st">"GLORIA"</span>, <span class="st">"ISABEL"</span>, <span class="st">"NORMA"</span>, <span class="st">"ALICIA"</span>,</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SILVIA"</span>, <span class="st">"GUADALUPE"</span>, <span class="st">"BLANCA"</span>, <span class="st">"MARGARITA"</span>, <span class="st">"JULIA"</span>, <span class="st">"PAULA"</span>,</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"DANIELA"</span>, <span class="st">"CAROLINA"</span>, <span class="st">"NATALIA"</span>, <span class="st">"VALERIA"</span>, <span class="st">"FERNANDA"</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>  sex <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="fu">length</span>(names_vector))</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(names_vector)) {</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(names_upper[i]) <span class="sc">||</span> names_upper[i] <span class="sc">==</span> <span class="st">""</span>) {</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>      sex[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>      first_name <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(names_upper[i], <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (first_name <span class="sc">%in%</span> male_names) {</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        sex[i] <span class="ot">&lt;-</span> <span class="st">"Male"</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (first_name <span class="sc">%in%</span> female_names) {</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>        sex[i] <span class="ot">&lt;-</span> <span class="st">"Female"</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"A$|E$"</span>, first_name)) {</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Female"</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"O$|[^AEIOU]$"</span>, first_name)) {</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Male"</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>          sex[i] <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sex)</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar sexo al dataframe</span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>Hiper1<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">extract_sex</span>(Hiper1<span class="sc">$</span>NOMBRE)</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>Hiper1<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(Hiper1<span class="sc">$</span>Sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Unknown"</span>))</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>Hiper1 <span class="ot">&lt;-</span> Hiper1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">|</span> <span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR DATASET EXPANDIDO POR OJO</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear dataset largo con una fila por ojo para análisis de atrofia/Frisen</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>Hiper1_eyes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>  Hiper1 <span class="sc">%&gt;%</span> </span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Frisen =</span> <span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Eye =</span> <span class="st">"OD"</span>),</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>  Hiper1 <span class="sc">%&gt;%</span> </span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Frisen =</span> <span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Eye =</span> <span class="st">"OI"</span>)</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCIONES AUXILIARES</span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para limpiar nombres de columnas</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>clean_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(I</span><span class="sc">\\</span><span class="st">)_"</span>, <span class="st">""</span>, x)</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(II</span><span class="sc">\\</span><span class="st">)_"</span>, <span class="st">""</span>, x)</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_1$|_2$"</span>, <span class="st">""</span>, x)</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, x)</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">..*"</span>, <span class="st">""</span>, x)</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">trimws</span>(x)</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de traducción ampliada (CORREGIDA)</span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>translate_var <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>  translations <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Edad"</span> <span class="ot">=</span> <span class="st">"Age"</span>,</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"EDAD"</span> <span class="ot">=</span> <span class="st">"Age"</span>,</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sexo"</span> <span class="ot">=</span> <span class="st">"Sex"</span>,</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sex"</span> <span class="ot">=</span> <span class="st">"Sex"</span>,</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del NO"</span> <span class="ot">=</span> <span class="st">"ON width"</span>,</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Virchow Robin medida"</span> <span class="ot">=</span> <span class="st">"Virchow Robin measurement"</span>,</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel width"</span>,</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Circunferencia del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel circumference"</span>,</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ancho del 3ro"</span> <span class="ot">=</span> <span class="st">"3rd ventricle width"</span>,</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Altura del Aracnoidocele"</span> <span class="ot">=</span> <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Descenso tonsilar cuantitativo"</span> <span class="ot">=</span> <span class="st">"Quantitative tonsillar descent"</span>,</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Espesor del TCS nucal"</span> <span class="ot">=</span> <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distancia talamomesencefalica"</span> <span class="ot">=</span> <span class="st">"Thalamo-mesencephalic distance"</span>,</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Atrio"</span> <span class="ot">=</span> <span class="st">"Atrium"</span>,</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"VL frontal"</span> <span class="ot">=</span> <span class="st">"Frontal VL"</span>,</span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tercer Ventriculo"</span> <span class="ot">=</span> <span class="st">"Third Ventricle"</span>,</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Presión LCR"</span> <span class="ot">=</span> <span class="st">"CSF Pressure"</span>,</span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tiempo sin ACTZ"</span> <span class="ot">=</span> <span class="st">"Time without ACTZ"</span>,</span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Válvula derivativa"</span> <span class="ot">=</span> <span class="st">"Shunt valve"</span>,</span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia"</span> <span class="ot">=</span> <span class="st">"ON atrophy"</span>,</span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia OD"</span> <span class="ot">=</span> <span class="st">"ON atrophy RE"</span>,</span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CV atrofia OI"</span> <span class="ot">=</span> <span class="st">"ON atrophy LE"</span>,</span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen"</span> <span class="ot">=</span> <span class="st">"Frisen Grade"</span>,</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen OD"</span> <span class="ot">=</span> <span class="st">"Frisen Grade RE"</span>,</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frisen OI"</span> <span class="ot">=</span> <span class="st">"Frisen Grade LE"</span>,</span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención de vainas NO"</span> <span class="ot">=</span> <span class="st">"ON sheath distention"</span>,</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención III NC"</span> <span class="ot">=</span> <span class="st">"CN III distention"</span>,</span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Distención  NC"</span> <span class="ot">=</span> <span class="st">"CN distention"</span>,</span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aplanamiento posterior del globo"</span> <span class="ot">=</span> <span class="st">"Posterior globe flattening"</span>,</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Protrusión del disco óptico"</span> <span class="ot">=</span> <span class="st">"Optic disc protrusion"</span>,</span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Realce del NO"</span> <span class="ot">=</span> <span class="st">"ON enhancement"</span>,</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meckel prominente"</span> <span class="ot">=</span> <span class="st">"Prominent Meckel"</span>,</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Forma del Meckel"</span> <span class="ot">=</span> <span class="st">"Meckel shape"</span>,</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Granulaciones Aracnoideas"</span> <span class="ot">=</span> <span class="st">"Arachnoid granulations"</span>,</span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aracnoidocele Selar"</span> <span class="ot">=</span> <span class="st">"Sellar arachnoidocele"</span>,</span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Silla turca amplia aracnoidocele expansivo"</span> <span class="ot">=</span> <span class="st">"Enlarged sella turcica with expansive arachnoidocele"</span>,  <span class="co"># CORREGIDA</span></span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Silla turca amplia (aracnoidocele expansivo)"</span> <span class="ot">=</span> <span class="st">"Enlarged sella turcica with expansive arachnoidocele"</span>, <span class="co"># AGREGADA</span></span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meningocele"</span> <span class="ot">=</span> <span class="st">"Meningocele"</span>,</span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meningoencefalocele"</span> <span class="ot">=</span> <span class="st">"Meningoencephalocele"</span>,</span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Descenso tonsilar"</span> <span class="ot">=</span> <span class="st">"Tonsillar descent"</span>,</span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Estenosis seno sigmoideo"</span> <span class="ot">=</span> <span class="st">"Sigmoid sinus stenosis"</span>,</span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cefalea crónica"</span> <span class="ot">=</span> <span class="st">"Chronic headache"</span>,</span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Otra Cx"</span> <span class="ot">=</span> <span class="st">"Other surgery"</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(old <span class="cf">in</span> <span class="fu">names</span>(translations)) {</span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(old, translations[old], x)</span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Función combinada para visualización</span></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a>clean_and_translate <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">translate_var</span>(<span class="fu">clean_names</span>(x))</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a><span class="co"># TABLA 0: DESCRIPCIÓN COMPLETA DE LA MUESTRA BASAL (VERSIÓN MEJORADA)</span></span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Reemplazar la sección original de TABLA 0 con este código</span></span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para formatear estadísticas continuas</span></span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a>format_continuous <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a>  vals <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data[[var]])</span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(vals) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, <span class="fu">mean</span>(vals), <span class="fu">sd</span>(vals)))</span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"NA"</span>)</span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para formatear estadísticas categóricas</span></span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a>format_categorical <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var, <span class="at">category =</span> <span class="st">"Present"</span>) {</span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.factor</span>(data[[var]]) <span class="sc">||</span> <span class="fu">is.character</span>(data[[var]])) {</span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[var]])</span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a>    n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (category <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[category]</span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"Female"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para variable Sex, mostrar Female</span></span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[<span class="st">"Female"</span>]</span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl)) {</span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> tbl[<span class="st">"Yes"</span>]</span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> (n <span class="sc">/</span> n_total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n, pct))</span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para variables multiclase como Frisen, mostrar distribución completa</span></span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">sprintf</span>(<span class="st">"%s: %d (%.1f)"</span>, </span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">names</span>(tbl), tbl, (tbl<span class="sc">/</span>n_total)<span class="sc">*</span><span class="dv">100</span>), </span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collapse =</span> <span class="st">"; "</span>)</span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(result)</span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">"NA"</span>)</span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos basales usando el dataset Hiper1 (a nivel paciente, no expandido)</span></span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a>descriptive_data <span class="ot">&lt;-</span> Hiper1 <span class="sc">%&gt;%</span></span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables demográficas y clínicas</span></span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> Edad,</span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">CSF_Pressure =</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>,</span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time_without_ACTZ =</span> <span class="st">`</span><span class="at">Tiempo sin ACTZ</span><span class="st">`</span>,</span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables numéricas tiempo 1 (basales)</span></span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del NO</span><span class="st">`</span>,</span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">Virchow_Robin_T1 =</span> <span class="st">`</span><span class="at">(I)_Virchow Robin medida</span><span class="st">`</span>,</span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del Meckel</span><span class="st">`</span>, </span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_circumference_T1 =</span> <span class="st">`</span><span class="at">(I)_Circunferencia del Meckel</span><span class="st">`</span>,</span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">Third_ventricle_width_T1 =</span> <span class="st">`</span><span class="at">(I)_Ancho del 3ro</span><span class="st">`</span>,</span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a>    <span class="at">Arachnoidocele_height_T1 =</span> <span class="st">`</span><span class="at">(I)_Altura del Aracnoidocele</span><span class="st">`</span>,</span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tonsillar_descent_T1 =</span> <span class="st">`</span><span class="at">(I)_Descenso tonsilar cuantitativo</span><span class="st">`</span>,</span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nuchal_SCT_T1 =</span> <span class="st">`</span><span class="at">(I)_Espesor del TCS nucal</span><span class="st">`</span>,</span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">Thalamo_mesencephalic_T1 =</span> <span class="st">`</span><span class="at">(I)_Distancia talamomesencefalica</span><span class="st">`</span>,</span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">Atrium_T1 =</span> <span class="st">`</span><span class="at">(I)_Atrio</span><span class="st">`</span>,</span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frontal_VL_T1 =</span> <span class="st">`</span><span class="at">(I)_VL frontal</span><span class="st">`</span>,</span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">Third_ventricle_T1 =</span> <span class="st">`</span><span class="at">(I)_Tercer Ventriculo</span><span class="st">`</span>,</span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables de atrofia y grado por ojo</span></span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shunt_valve =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_atrophy_OD =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia OD</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_atrophy_OI =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia OI</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frisen_Grade_OD =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Frisen OD</span><span class="st">`</span>),</span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frisen_Grade_OI =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Frisen OI</span><span class="st">`</span>),</span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chronic_headache =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Cefalea crónica</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_surgery =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Otra Cx</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)),</span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables categóricas tiempo 1</span></span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_sheath_distention_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención de vainas NO</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">CN_III_distention_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención III NC</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">Posterior_globe_flattening_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aplanamiento posterior del globo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">Optic_disc_protrusion_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Protrusión del disco óptico</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-278"><a href="#cb13-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">ON_enhancement_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Realce del NO</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-279"><a href="#cb13-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prominent_Meckel_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meckel prominente</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-280"><a href="#cb13-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meckel_shape_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Forma del Meckel</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type3"</span>)),</span>
<span id="cb13-281"><a href="#cb13-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">Arachnoid_granulations_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Granulaciones Aracnoideas</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-282"><a href="#cb13-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meningocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningocele</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-283"><a href="#cb13-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">Meningoencephalocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningoencefalocele</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-284"><a href="#cb13-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sellar_arachnoidocele_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aracnoidocele Selar</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-285"><a href="#cb13-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">Enlarged_sella_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-286"><a href="#cb13-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tonsillar_descent_cat_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Descenso tonsilar</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-287"><a href="#cb13-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigmoid_stenosis_T1 =</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Estenosis seno sigmoideo</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)),</span>
<span id="cb13-288"><a href="#cb13-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> Sex</span>
<span id="cb13-289"><a href="#cb13-289" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-290"><a href="#cb13-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-291"><a href="#cb13-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular n para cada grupo</span></span>
<span id="cb13-292"><a href="#cb13-292" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(descriptive_data)</span>
<span id="cb13-293"><a href="#cb13-293" aria-hidden="true" tabindex="-1"></a>n_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(descriptive_data<span class="sc">$</span>Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-294"><a href="#cb13-294" aria-hidden="true" tabindex="-1"></a>n_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(descriptive_data<span class="sc">$</span>Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-295"><a href="#cb13-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-296"><a href="#cb13-296" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla descriptiva completa</span></span>
<span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a>TABLA0_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables demográficas</span></span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a>demo_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Age"</span>, <span class="at">name =</span> <span class="st">"Age (years)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sex"</span>, <span class="at">name =</span> <span class="st">"Sex (Female)"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"CSF_Pressure"</span>, <span class="at">name =</span> <span class="st">"CSF Pressure (cmH2O)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Time_without_ACTZ"</span>, <span class="at">name =</span> <span class="st">"Time without ACTZ (days)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de imagen cuantitativas</span></span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a>imaging_quant_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_width_T1"</span>, <span class="at">name =</span> <span class="st">"ON width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Virchow_Robin_T1"</span>, <span class="at">name =</span> <span class="st">"Virchow Robin measurement (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_width_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_circumference_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel circumference (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Third_ventricle_width_T1"</span>, <span class="at">name =</span> <span class="st">"3rd ventricle width (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Arachnoidocele_height_T1"</span>, <span class="at">name =</span> <span class="st">"Arachnoidocele height (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Tonsillar_descent_T1"</span>, <span class="at">name =</span> <span class="st">"Tonsillar descent (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Nuchal_SCT_T1"</span>, <span class="at">name =</span> <span class="st">"Nuchal SCT thickness (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Thalamo_mesencephalic_T1"</span>, <span class="at">name =</span> <span class="st">"Thalamo-mesencephalic distance (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Atrium_T1"</span>, <span class="at">name =</span> <span class="st">"Atrium (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-319"><a href="#cb13-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frontal_VL_T1"</span>, <span class="at">name =</span> <span class="st">"Frontal VL (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-320"><a href="#cb13-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Third_ventricle_T1"</span>, <span class="at">name =</span> <span class="st">"Third Ventricle (mm)"</span>, <span class="at">cat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-321"><a href="#cb13-321" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-322"><a href="#cb13-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-323"><a href="#cb13-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de atrofia y grado por ojo</span></span>
<span id="cb13-324"><a href="#cb13-324" aria-hidden="true" tabindex="-1"></a>atrophy_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-325"><a href="#cb13-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_atrophy_OD"</span>, <span class="at">name =</span> <span class="st">"ON atrophy OD"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-326"><a href="#cb13-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_atrophy_OI"</span>, <span class="at">name =</span> <span class="st">"ON atrophy OI"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-327"><a href="#cb13-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frisen_Grade_OD"</span>, <span class="at">name =</span> <span class="st">"Frisen Grade OD"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-328"><a href="#cb13-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Frisen_Grade_OI"</span>, <span class="at">name =</span> <span class="st">"Frisen Grade OI"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-329"><a href="#cb13-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Chronic_headache"</span>, <span class="at">name =</span> <span class="st">"Chronic headache"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-330"><a href="#cb13-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Other_surgery"</span>, <span class="at">name =</span> <span class="st">"Other surgery"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-331"><a href="#cb13-331" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-332"><a href="#cb13-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-333"><a href="#cb13-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables de signos de imagen categóricas</span></span>
<span id="cb13-334"><a href="#cb13-334" aria-hidden="true" tabindex="-1"></a>imaging_cat_vars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-335"><a href="#cb13-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_sheath_distention_T1"</span>, <span class="at">name =</span> <span class="st">"ON sheath distention"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-336"><a href="#cb13-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"CN_III_distention_T1"</span>, <span class="at">name =</span> <span class="st">"CN III distention"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-337"><a href="#cb13-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Posterior_globe_flattening_T1"</span>, <span class="at">name =</span> <span class="st">"Posterior globe flattening"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-338"><a href="#cb13-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Optic_disc_protrusion_T1"</span>, <span class="at">name =</span> <span class="st">"Optic disc protrusion"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-339"><a href="#cb13-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"ON_enhancement_T1"</span>, <span class="at">name =</span> <span class="st">"ON enhancement"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-340"><a href="#cb13-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Prominent_Meckel_T1"</span>, <span class="at">name =</span> <span class="st">"Prominent Meckel"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-341"><a href="#cb13-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meckel_shape_T1"</span>, <span class="at">name =</span> <span class="st">"Meckel shape"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-342"><a href="#cb13-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Arachnoid_granulations_T1"</span>, <span class="at">name =</span> <span class="st">"Arachnoid granulations"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-343"><a href="#cb13-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meningocele_T1"</span>, <span class="at">name =</span> <span class="st">"Meningocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-344"><a href="#cb13-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Meningoencephalocele_T1"</span>, <span class="at">name =</span> <span class="st">"Meningoencephalocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-345"><a href="#cb13-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sellar_arachnoidocele_T1"</span>, <span class="at">name =</span> <span class="st">"Sellar arachnoidocele"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-346"><a href="#cb13-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Enlarged_sella_T1"</span>, <span class="at">name =</span> <span class="st">"Enlarged sella turcica"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-347"><a href="#cb13-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Tonsillar_descent_cat_T1"</span>, <span class="at">name =</span> <span class="st">"Tonsillar descent (categorical)"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-348"><a href="#cb13-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">var =</span> <span class="st">"Sigmoid_stenosis_T1"</span>, <span class="at">name =</span> <span class="st">"Sigmoid sinus stenosis"</span>, <span class="at">cat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-349"><a href="#cb13-349" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-350"><a href="#cb13-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-351"><a href="#cb13-351" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar todas las variables</span></span>
<span id="cb13-352"><a href="#cb13-352" aria-hidden="true" tabindex="-1"></a>all_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(demo_vars, imaging_quant_vars, atrophy_vars, imaging_cat_vars)</span>
<span id="cb13-353"><a href="#cb13-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-354"><a href="#cb13-354" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear filas de la tabla</span></span>
<span id="cb13-355"><a href="#cb13-355" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> all_vars) {</span>
<span id="cb13-356"><a href="#cb13-356" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (v<span class="sc">$</span>cat) {</span>
<span id="cb13-357"><a href="#cb13-357" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables categóricas</span></span>
<span id="cb13-358"><a href="#cb13-358" aria-hidden="true" tabindex="-1"></a>    overall <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(descriptive_data, v<span class="sc">$</span>var)</span>
<span id="cb13-359"><a href="#cb13-359" aria-hidden="true" tabindex="-1"></a>    with_valve <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>), v<span class="sc">$</span>var)</span>
<span id="cb13-360"><a href="#cb13-360" aria-hidden="true" tabindex="-1"></a>    without_valve <span class="ot">&lt;-</span> <span class="fu">format_categorical</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>), v<span class="sc">$</span>var)</span>
<span id="cb13-361"><a href="#cb13-361" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-362"><a href="#cb13-362" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test estadístico para categóricas</span></span>
<span id="cb13-363"><a href="#cb13-363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Frisen"</span>, v<span class="sc">$</span>var)) {</span>
<span id="cb13-364"><a href="#cb13-364" aria-hidden="true" tabindex="-1"></a>      tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(descriptive_data[[v<span class="sc">$</span>var]], descriptive_data<span class="sc">$</span>Shunt_valve)</span>
<span id="cb13-365"><a href="#cb13-365" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">ncol</span>(tbl) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb13-366"><a href="#cb13-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">min</span>(tbl) <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb13-367"><a href="#cb13-367" aria-hidden="true" tabindex="-1"></a>          p_val <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(tbl)<span class="sc">$</span>p.value</span>
<span id="cb13-368"><a href="#cb13-368" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb13-369"><a href="#cb13-369" aria-hidden="true" tabindex="-1"></a>          p_val <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(tbl))<span class="sc">$</span>p.value</span>
<span id="cb13-370"><a href="#cb13-370" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-371"><a href="#cb13-371" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb13-372"><a href="#cb13-372" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-373"><a href="#cb13-373" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-374"><a href="#cb13-374" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb13-375"><a href="#cb13-375" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Para Frisen Grade usar test no paramétrico</span></span>
<span id="cb13-376"><a href="#cb13-376" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(descriptive_data[[v<span class="sc">$</span>var]])) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb13-377"><a href="#cb13-377" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="fu">as.numeric</span>(descriptive_data[[v<span class="sc">$</span>var]]) <span class="sc">~</span> descriptive_data<span class="sc">$</span>Shunt_valve)<span class="sc">$</span>p.value</span>
<span id="cb13-378"><a href="#cb13-378" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb13-379"><a href="#cb13-379" aria-hidden="true" tabindex="-1"></a>        p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-380"><a href="#cb13-380" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-381"><a href="#cb13-381" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-382"><a href="#cb13-382" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-383"><a href="#cb13-383" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables continuas</span></span>
<span id="cb13-384"><a href="#cb13-384" aria-hidden="true" tabindex="-1"></a>    overall <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(descriptive_data, v<span class="sc">$</span>var)</span>
<span id="cb13-385"><a href="#cb13-385" aria-hidden="true" tabindex="-1"></a>    with_valve <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"Yes"</span>), v<span class="sc">$</span>var)</span>
<span id="cb13-386"><a href="#cb13-386" aria-hidden="true" tabindex="-1"></a>    without_valve <span class="ot">&lt;-</span> <span class="fu">format_continuous</span>(<span class="fu">filter</span>(descriptive_data, Shunt_valve <span class="sc">==</span> <span class="st">"No"</span>), v<span class="sc">$</span>var)</span>
<span id="cb13-387"><a href="#cb13-387" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-388"><a href="#cb13-388" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test t para continuas</span></span>
<span id="cb13-389"><a href="#cb13-389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(descriptive_data[[v<span class="sc">$</span>var]])) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb13-390"><a href="#cb13-390" aria-hidden="true" tabindex="-1"></a>      p_val <span class="ot">&lt;-</span> <span class="fu">t.test</span>(descriptive_data[[v<span class="sc">$</span>var]] <span class="sc">~</span> descriptive_data<span class="sc">$</span>Shunt_valve)<span class="sc">$</span>p.value</span>
<span id="cb13-391"><a href="#cb13-391" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb13-392"><a href="#cb13-392" aria-hidden="true" tabindex="-1"></a>      p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-393"><a href="#cb13-393" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-394"><a href="#cb13-394" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-395"><a href="#cb13-395" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-396"><a href="#cb13-396" aria-hidden="true" tabindex="-1"></a>  TABLA0_rows[[<span class="fu">length</span>(TABLA0_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-397"><a href="#cb13-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> v<span class="sc">$</span>name,</span>
<span id="cb13-398"><a href="#cb13-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">Overall =</span> overall,</span>
<span id="cb13-399"><a href="#cb13-399" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">With Valve</span><span class="st">`</span> <span class="ot">=</span> with_valve,</span>
<span id="cb13-400"><a href="#cb13-400" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Without Valve</span><span class="st">`</span> <span class="ot">=</span> without_valve,</span>
<span id="cb13-401"><a href="#cb13-401" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(p_val), <span class="st">"NA"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p_val)),</span>
<span id="cb13-402"><a href="#cb13-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-403"><a href="#cb13-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-404"><a href="#cb13-404" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-405"><a href="#cb13-405" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-406"><a href="#cb13-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-407"><a href="#cb13-407" aria-hidden="true" tabindex="-1"></a>TABLA0_BASELINE <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA0_rows)</span>
<span id="cb13-408"><a href="#cb13-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-409"><a href="#cb13-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Actualizar encabezados con números</span></span>
<span id="cb13-410"><a href="#cb13-410" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(TABLA0_BASELINE) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, </span>
<span id="cb13-411"><a href="#cb13-411" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"Overall (n="</span>, n_total, <span class="st">")"</span>),</span>
<span id="cb13-412"><a href="#cb13-412" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"With Valve (n="</span>, n_valve, <span class="st">")"</span>),</span>
<span id="cb13-413"><a href="#cb13-413" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"Without Valve (n="</span>, n_no_valve, <span class="st">")"</span>),</span>
<span id="cb13-414"><a href="#cb13-414" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"p value"</span>)</span>
<span id="cb13-415"><a href="#cb13-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-416"><a href="#cb13-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-417"><a href="#cb13-417" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-418"><a href="#cb13-418" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 1: VARIABLES CONTINUAS PRE-POST (NIVEL PACIENTE)</span></span>
<span id="cb13-419"><a href="#cb13-419" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-420"><a href="#cb13-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-421"><a href="#cb13-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas para análisis pre-post</span></span>
<span id="cb13-422"><a href="#cb13-422" aria-hidden="true" tabindex="-1"></a>HiperOrd <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">49</span><span class="sc">:</span><span class="dv">52</span>,<span class="dv">55</span><span class="sc">:</span><span class="dv">58</span>,<span class="dv">59</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">61</span><span class="sc">:</span><span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>,<span class="dv">71</span>)]</span>
<span id="cb13-423"><a href="#cb13-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-424"><a href="#cb13-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar que las columnas sean numéricas (excepto la válvula)</span></span>
<span id="cb13-425"><a href="#cb13-425" aria-hidden="true" tabindex="-1"></a>cols_to_check <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">26</span>)</span>
<span id="cb13-426"><a href="#cb13-426" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> cols_to_check) {</span>
<span id="cb13-427"><a href="#cb13-427" aria-hidden="true" tabindex="-1"></a>  HiperOrd[,col] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[col]])</span>
<span id="cb13-428"><a href="#cb13-428" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-429"><a href="#cb13-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-430"><a href="#cb13-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar válvula derivativa</span></span>
<span id="cb13-431"><a href="#cb13-431" aria-hidden="true" tabindex="-1"></a>HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>,</span>
<span id="cb13-432"><a href="#cb13-432" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb13-433"><a href="#cb13-433" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb13-434"><a href="#cb13-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-435"><a href="#cb13-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas t pareadas y ANCOVA</span></span>
<span id="cb13-436"><a href="#cb13-436" aria-hidden="true" tabindex="-1"></a>ANCOVAS <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-437"><a href="#cb13-437" aria-hidden="true" tabindex="-1"></a>TEMP <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-438"><a href="#cb13-438" aria-hidden="true" tabindex="-1"></a>TTEST <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-439"><a href="#cb13-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-440"><a href="#cb13-440" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)) {</span>
<span id="cb13-441"><a href="#cb13-441" aria-hidden="true" tabindex="-1"></a>  ANCOVAS[[i]] <span class="ot">&lt;-</span> <span class="fu">aov</span>(HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]] <span class="sc">~</span> HiperOrd[[i]] <span class="sc">+</span> HiperOrd[[<span class="st">"Válvula derivativa"</span>]])</span>
<span id="cb13-442"><a href="#cb13-442" aria-hidden="true" tabindex="-1"></a>  TEMP[[i]] <span class="ot">&lt;-</span> <span class="fu">summary</span>(ANCOVAS[[i]])</span>
<span id="cb13-443"><a href="#cb13-443" aria-hidden="true" tabindex="-1"></a>  TTEST[[i]] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(HiperOrd[[i]], HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]], </span>
<span id="cb13-444"><a href="#cb13-444" aria-hidden="true" tabindex="-1"></a>                        <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb13-445"><a href="#cb13-445" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-446"><a href="#cb13-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-447"><a href="#cb13-447" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de resultados</span></span>
<span id="cb13-448"><a href="#cb13-448" aria-hidden="true" tabindex="-1"></a>TABLA1_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-449"><a href="#cb13-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-450"><a href="#cb13-450" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)) {</span>
<span id="cb13-451"><a href="#cb13-451" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">colnames</span>(HiperOrd[,i]))</span>
<span id="cb13-452"><a href="#cb13-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-453"><a href="#cb13-453" aria-hidden="true" tabindex="-1"></a>  vals_t1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[i]])</span>
<span id="cb13-454"><a href="#cb13-454" aria-hidden="true" tabindex="-1"></a>  mean1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-455"><a href="#cb13-455" aria-hidden="true" tabindex="-1"></a>  sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-456"><a href="#cb13-456" aria-hidden="true" tabindex="-1"></a>  t1_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean1, sd1)</span>
<span id="cb13-457"><a href="#cb13-457" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-458"><a href="#cb13-458" aria-hidden="true" tabindex="-1"></a>  vals_t2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[i<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb13-459"><a href="#cb13-459" aria-hidden="true" tabindex="-1"></a>  mean2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-460"><a href="#cb13-460" aria-hidden="true" tabindex="-1"></a>  sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-461"><a href="#cb13-461" aria-hidden="true" tabindex="-1"></a>  t2_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean2, sd2)</span>
<span id="cb13-462"><a href="#cb13-462" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-463"><a href="#cb13-463" aria-hidden="true" tabindex="-1"></a>  valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"Yes"</span></span>
<span id="cb13-464"><a href="#cb13-464" aria-hidden="true" tabindex="-1"></a>  no_valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"No"</span></span>
<span id="cb13-465"><a href="#cb13-465" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-466"><a href="#cb13-466" aria-hidden="true" tabindex="-1"></a>  vals_valve <span class="ot">&lt;-</span> vals_t2[valve_mask]</span>
<span id="cb13-467"><a href="#cb13-467" aria-hidden="true" tabindex="-1"></a>  mean_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-468"><a href="#cb13-468" aria-hidden="true" tabindex="-1"></a>  sd_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-469"><a href="#cb13-469" aria-hidden="true" tabindex="-1"></a>  valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_valve, sd_valve)</span>
<span id="cb13-470"><a href="#cb13-470" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-471"><a href="#cb13-471" aria-hidden="true" tabindex="-1"></a>  vals_no_valve <span class="ot">&lt;-</span> vals_t2[no_valve_mask]</span>
<span id="cb13-472"><a href="#cb13-472" aria-hidden="true" tabindex="-1"></a>  mean_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-473"><a href="#cb13-473" aria-hidden="true" tabindex="-1"></a>  sd_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-474"><a href="#cb13-474" aria-hidden="true" tabindex="-1"></a>  no_valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_no_valve, sd_no_valve)</span>
<span id="cb13-475"><a href="#cb13-475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-476"><a href="#cb13-476" aria-hidden="true" tabindex="-1"></a>  TABLA1_rows[[<span class="fu">length</span>(TABLA1_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-477"><a href="#cb13-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-478"><a href="#cb13-478" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T1 (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> t1_stats,</span>
<span id="cb13-479"><a href="#cb13-479" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> t2_stats,</span>
<span id="cb13-480"><a href="#cb13-480" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Paired t)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, TTEST[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb13-481"><a href="#cb13-481" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 with Valve</span><span class="st">`</span> <span class="ot">=</span> valve_stats,</span>
<span id="cb13-482"><a href="#cb13-482" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 without Valve</span><span class="st">`</span> <span class="ot">=</span> no_valve_stats,</span>
<span id="cb13-483"><a href="#cb13-483" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (ANCOVA)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, TEMP[[i]][[<span class="dv">1</span>]][<span class="dv">2</span>,<span class="dv">5</span>]),</span>
<span id="cb13-484"><a href="#cb13-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-485"><a href="#cb13-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-486"><a href="#cb13-486" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-487"><a href="#cb13-487" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-488"><a href="#cb13-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-489"><a href="#cb13-489" aria-hidden="true" tabindex="-1"></a>TABLA1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA1_rows)</span>
<span id="cb13-490"><a href="#cb13-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-491"><a href="#cb13-491" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-492"><a href="#cb13-492" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 2: VARIABLES CATEGÓRICAS PRE-POST (NIVEL PACIENTE)</span></span>
<span id="cb13-493"><a href="#cb13-493" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-494"><a href="#cb13-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-495"><a href="#cb13-495" aria-hidden="true" tabindex="-1"></a>HiperOrd2 <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">18</span>,<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">27</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">33</span><span class="sc">:</span><span class="dv">36</span>,<span class="dv">37</span>,<span class="dv">39</span>,<span class="dv">41</span>,<span class="dv">42</span>,<span class="dv">45</span><span class="sc">:</span><span class="dv">48</span>,<span class="dv">53</span>,<span class="dv">54</span>,<span class="dv">64</span>,<span class="dv">66</span><span class="sc">:</span><span class="dv">70</span>)]</span>
<span id="cb13-496"><a href="#cb13-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-497"><a href="#cb13-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar variables</span></span>
<span id="cb13-498"><a href="#cb13-498" aria-hidden="true" tabindex="-1"></a>factorizar <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">factor</span>(x, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb13-499"><a href="#cb13-499" aria-hidden="true" tabindex="-1"></a>HiperOrd2 <span class="ot">&lt;-</span> HiperOrd2 <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">30</span>), factorizar)</span>
<span id="cb13-500"><a href="#cb13-500" aria-hidden="true" tabindex="-1"></a>HiperOrd2<span class="fl">.2</span> <span class="ot">&lt;-</span> HiperOrd2[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span><span class="sc">:</span><span class="dv">30</span>)]</span>
<span id="cb13-501"><a href="#cb13-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-502"><a href="#cb13-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de McNemar</span></span>
<span id="cb13-503"><a href="#cb13-503" aria-hidden="true" tabindex="-1"></a>MNT <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-504"><a href="#cb13-504" aria-hidden="true" tabindex="-1"></a>ODDS <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-505"><a href="#cb13-505" aria-hidden="true" tabindex="-1"></a>PROP1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-506"><a href="#cb13-506" aria-hidden="true" tabindex="-1"></a>PROP2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-507"><a href="#cb13-507" aria-hidden="true" tabindex="-1"></a>CHIT <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-508"><a href="#cb13-508" aria-hidden="true" tabindex="-1"></a>PROPVD <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-509"><a href="#cb13-509" aria-hidden="true" tabindex="-1"></a>ODDS2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-510"><a href="#cb13-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-511"><a href="#cb13-511" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">2</span>)){</span>
<span id="cb13-512"><a href="#cb13-512" aria-hidden="true" tabindex="-1"></a>  MNT[[i]] <span class="ot">&lt;-</span> HiperOrd2<span class="fl">.2</span>[,<span class="fu">c</span>(i,i<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb13-513"><a href="#cb13-513" aria-hidden="true" tabindex="-1"></a>  PROP1[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i])))</span>
<span id="cb13-514"><a href="#cb13-514" aria-hidden="true" tabindex="-1"></a>  PROP2[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i<span class="sc">+</span><span class="dv">1</span>])))</span>
<span id="cb13-515"><a href="#cb13-515" aria-hidden="true" tabindex="-1"></a>  ODDS[[i]] <span class="ot">&lt;-</span> <span class="fu">mcnemar.test</span>(<span class="fu">table</span>(MNT[[i]]))</span>
<span id="cb13-516"><a href="#cb13-516" aria-hidden="true" tabindex="-1"></a>  CHIT[[i]] <span class="ot">&lt;-</span> HiperOrd2<span class="fl">.2</span>[,<span class="fu">c</span>(i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">27</span>)]</span>
<span id="cb13-517"><a href="#cb13-517" aria-hidden="true" tabindex="-1"></a>  PROPVD[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(CHIT[[i]])))</span>
<span id="cb13-518"><a href="#cb13-518" aria-hidden="true" tabindex="-1"></a>  ODDS2[[i]] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(CHIT[[i]])))</span>
<span id="cb13-519"><a href="#cb13-519" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-520"><a href="#cb13-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-521"><a href="#cb13-521" aria-hidden="true" tabindex="-1"></a>TABLA2_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-522"><a href="#cb13-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-523"><a href="#cb13-523" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">2</span>)) {</span>
<span id="cb13-524"><a href="#cb13-524" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">colnames</span>(HiperOrd2<span class="fl">.2</span>[,i]))</span>
<span id="cb13-525"><a href="#cb13-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-526"><a href="#cb13-526" aria-hidden="true" tabindex="-1"></a>  tbl1 <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i])</span>
<span id="cb13-527"><a href="#cb13-527" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl1)) {</span>
<span id="cb13-528"><a href="#cb13-528" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> tbl1[<span class="st">"Yes"</span>]</span>
<span id="cb13-529"><a href="#cb13-529" aria-hidden="true" tabindex="-1"></a>    pct1 <span class="ot">&lt;-</span> (n1 <span class="sc">/</span> <span class="fu">sum</span>(tbl1)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-530"><a href="#cb13-530" aria-hidden="true" tabindex="-1"></a>    t1_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n1, pct1)</span>
<span id="cb13-531"><a href="#cb13-531" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-532"><a href="#cb13-532" aria-hidden="true" tabindex="-1"></a>    t1_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb13-533"><a href="#cb13-533" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-534"><a href="#cb13-534" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-535"><a href="#cb13-535" aria-hidden="true" tabindex="-1"></a>  tbl2 <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[,i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb13-536"><a href="#cb13-536" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl2)) {</span>
<span id="cb13-537"><a href="#cb13-537" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> tbl2[<span class="st">"Yes"</span>]</span>
<span id="cb13-538"><a href="#cb13-538" aria-hidden="true" tabindex="-1"></a>    pct2 <span class="ot">&lt;-</span> (n2 <span class="sc">/</span> <span class="fu">sum</span>(tbl2)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-539"><a href="#cb13-539" aria-hidden="true" tabindex="-1"></a>    t2_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n2, pct2)</span>
<span id="cb13-540"><a href="#cb13-540" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-541"><a href="#cb13-541" aria-hidden="true" tabindex="-1"></a>    t2_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb13-542"><a href="#cb13-542" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-543"><a href="#cb13-543" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-544"><a href="#cb13-544" aria-hidden="true" tabindex="-1"></a>  tbl_valve <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[HiperOrd2<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"Yes"</span>, i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb13-545"><a href="#cb13-545" aria-hidden="true" tabindex="-1"></a>  tbl_no_valve <span class="ot">&lt;-</span> <span class="fu">table</span>(HiperOrd2<span class="fl">.2</span>[HiperOrd2<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span><span class="sc">==</span><span class="st">"No"</span>, i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb13-546"><a href="#cb13-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-547"><a href="#cb13-547" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl_valve)) {</span>
<span id="cb13-548"><a href="#cb13-548" aria-hidden="true" tabindex="-1"></a>    n_valve <span class="ot">&lt;-</span> tbl_valve[<span class="st">"Yes"</span>]</span>
<span id="cb13-549"><a href="#cb13-549" aria-hidden="true" tabindex="-1"></a>    pct_valve <span class="ot">&lt;-</span> (n_valve <span class="sc">/</span> <span class="fu">sum</span>(tbl_valve)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-550"><a href="#cb13-550" aria-hidden="true" tabindex="-1"></a>    valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n_valve, pct_valve)</span>
<span id="cb13-551"><a href="#cb13-551" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-552"><a href="#cb13-552" aria-hidden="true" tabindex="-1"></a>    valve_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb13-553"><a href="#cb13-553" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-554"><a href="#cb13-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-555"><a href="#cb13-555" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Yes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tbl_no_valve)) {</span>
<span id="cb13-556"><a href="#cb13-556" aria-hidden="true" tabindex="-1"></a>    n_no_valve <span class="ot">&lt;-</span> tbl_no_valve[<span class="st">"Yes"</span>]</span>
<span id="cb13-557"><a href="#cb13-557" aria-hidden="true" tabindex="-1"></a>    pct_no_valve <span class="ot">&lt;-</span> (n_no_valve <span class="sc">/</span> <span class="fu">sum</span>(tbl_no_valve)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-558"><a href="#cb13-558" aria-hidden="true" tabindex="-1"></a>    no_valve_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f)"</span>, n_no_valve, pct_no_valve)</span>
<span id="cb13-559"><a href="#cb13-559" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-560"><a href="#cb13-560" aria-hidden="true" tabindex="-1"></a>    no_valve_stats <span class="ot">&lt;-</span> <span class="st">"0 (0.0)"</span></span>
<span id="cb13-561"><a href="#cb13-561" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-562"><a href="#cb13-562" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-563"><a href="#cb13-563" aria-hidden="true" tabindex="-1"></a>  TABLA2_rows[[<span class="fu">length</span>(TABLA2_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-564"><a href="#cb13-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-565"><a href="#cb13-565" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T1 n (%)</span><span class="st">`</span> <span class="ot">=</span> t1_stats,</span>
<span id="cb13-566"><a href="#cb13-566" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 n (%)</span><span class="st">`</span> <span class="ot">=</span> t2_stats,</span>
<span id="cb13-567"><a href="#cb13-567" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (McNemar)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, ODDS[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb13-568"><a href="#cb13-568" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 with Valve n (%)</span><span class="st">`</span> <span class="ot">=</span> valve_stats,</span>
<span id="cb13-569"><a href="#cb13-569" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T2 without Valve n (%)</span><span class="st">`</span> <span class="ot">=</span> no_valve_stats,</span>
<span id="cb13-570"><a href="#cb13-570" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Chi-square)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, ODDS2[[i]]<span class="sc">$</span>p.value),</span>
<span id="cb13-571"><a href="#cb13-571" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-572"><a href="#cb13-572" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-573"><a href="#cb13-573" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-574"><a href="#cb13-574" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-575"><a href="#cb13-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-576"><a href="#cb13-576" aria-hidden="true" tabindex="-1"></a>TABLA2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA2_rows)</span>
<span id="cb13-577"><a href="#cb13-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-578"><a href="#cb13-578" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-579"><a href="#cb13-579" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 3: ANÁLISIS DE ATROFIA (TODOS LOS OJOS COMO UNIDADES)</span></span>
<span id="cb13-580"><a href="#cb13-580" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-581"><a href="#cb13-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-582"><a href="#cb13-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos para análisis de atrofia - todos los ojos juntos</span></span>
<span id="cb13-583"><a href="#cb13-583" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="fu">seq</span>(<span class="dv">11</span>,<span class="dv">61</span>,<span class="dv">2</span>),<span class="dv">63</span><span class="sc">:</span><span class="dv">71</span>)]</span>
<span id="cb13-584"><a href="#cb13-584" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM[,<span class="sc">-</span><span class="dv">17</span>]</span>
<span id="cb13-585"><a href="#cb13-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-586"><a href="#cb13-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificar y factorizar variables categóricas</span></span>
<span id="cb13-587"><a href="#cb13-587" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM <span class="sc">%&gt;%</span> </span>
<span id="cb13-588"><a href="#cb13-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">31</span>,<span class="dv">33</span>), </span>
<span id="cb13-589"><a href="#cb13-589" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(<span class="sc">~</span><span class="fu">recode</span>(., <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>)))</span>
<span id="cb13-590"><a href="#cb13-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-591"><a href="#cb13-591" aria-hidden="true" tabindex="-1"></a>DATOSM <span class="ot">&lt;-</span> DATOSM <span class="sc">%&gt;%</span> </span>
<span id="cb13-592"><a href="#cb13-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span>,<span class="dv">29</span>,<span class="dv">31</span>,<span class="dv">33</span>), </span>
<span id="cb13-593"><a href="#cb13-593" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Absent"</span>,<span class="st">"Present"</span>))))</span>
<span id="cb13-594"><a href="#cb13-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-595"><a href="#cb13-595" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATOSM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">(I</span><span class="sc">\\</span><span class="st">)_'</span>,<span class="st">''</span>, <span class="fu">colnames</span>(DATOSM))</span>
<span id="cb13-596"><a href="#cb13-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-597"><a href="#cb13-597" aria-hidden="true" tabindex="-1"></a><span class="co"># Expandir datos para análisis por ojo</span></span>
<span id="cb13-598"><a href="#cb13-598" aria-hidden="true" tabindex="-1"></a>DATOSM_all_eyes <span class="ot">&lt;-</span> Hiper1_eyes <span class="sc">%&gt;%</span></span>
<span id="cb13-599"><a href="#cb13-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Edad =</span> Edad, <span class="st">`</span><span class="at">Ancho del NO</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del NO</span><span class="st">`</span>,</span>
<span id="cb13-600"><a href="#cb13-600" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ancho del 3ro</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del 3ro</span><span class="st">`</span>,</span>
<span id="cb13-601"><a href="#cb13-601" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Virchow Robin medida</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Virchow Robin medida</span><span class="st">`</span>,</span>
<span id="cb13-602"><a href="#cb13-602" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ancho del Meckel</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Ancho del Meckel</span><span class="st">`</span>,</span>
<span id="cb13-603"><a href="#cb13-603" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Circunferencia del Meckel</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Circunferencia del Meckel</span><span class="st">`</span>,</span>
<span id="cb13-604"><a href="#cb13-604" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Altura del Aracnoidocele</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Altura del Aracnoidocele</span><span class="st">`</span>,</span>
<span id="cb13-605"><a href="#cb13-605" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Descenso tonsilar cuantitativo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Descenso tonsilar cuantitativo</span><span class="st">`</span>,</span>
<span id="cb13-606"><a href="#cb13-606" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Espesor del TCS nucal</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Espesor del TCS nucal</span><span class="st">`</span>,</span>
<span id="cb13-607"><a href="#cb13-607" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Distancia talamomesencefalica</span><span class="st">`</span>,</span>
<span id="cb13-608"><a href="#cb13-608" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Atrio</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Atrio</span><span class="st">`</span>,</span>
<span id="cb13-609"><a href="#cb13-609" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">VL frontal</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_VL frontal</span><span class="st">`</span>,</span>
<span id="cb13-610"><a href="#cb13-610" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Tercer Ventriculo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(I)_Tercer Ventriculo</span><span class="st">`</span>,</span>
<span id="cb13-611"><a href="#cb13-611" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>,</span>
<span id="cb13-612"><a href="#cb13-612" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>,</span>
<span id="cb13-613"><a href="#cb13-613" aria-hidden="true" tabindex="-1"></a>         Frisen) <span class="sc">%&gt;%</span></span>
<span id="cb13-614"><a href="#cb13-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-615"><a href="#cb13-615" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Absent"</span>,<span class="st">"Present"</span>))</span>
<span id="cb13-616"><a href="#cb13-616" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-617"><a href="#cb13-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-618"><a href="#cb13-618" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis comparativo usando todos los ojos</span></span>
<span id="cb13-619"><a href="#cb13-619" aria-hidden="true" tabindex="-1"></a>TABLA3_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-620"><a href="#cb13-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-621"><a href="#cb13-621" aria-hidden="true" tabindex="-1"></a>vars_to_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Edad"</span>, <span class="st">"Ancho del NO"</span>, <span class="st">"Ancho del 3ro"</span>, <span class="st">"Virchow Robin medida"</span>,</span>
<span id="cb13-622"><a href="#cb13-622" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Ancho del Meckel"</span>, <span class="st">"Circunferencia del Meckel"</span>, </span>
<span id="cb13-623"><a href="#cb13-623" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Altura del Aracnoidocele"</span>, <span class="st">"Descenso tonsilar cuantitativo"</span>,</span>
<span id="cb13-624"><a href="#cb13-624" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Espesor del TCS nucal"</span>, <span class="st">"Distancia talamomesencefalica"</span>,</span>
<span id="cb13-625"><a href="#cb13-625" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Atrio"</span>, <span class="st">"VL frontal"</span>, <span class="st">"Tercer Ventriculo"</span>, <span class="st">"Presión LCR"</span>)</span>
<span id="cb13-626"><a href="#cb13-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-627"><a href="#cb13-627" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> vars_to_test) {</span>
<span id="cb13-628"><a href="#cb13-628" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb13-629"><a href="#cb13-629" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-630"><a href="#cb13-630" aria-hidden="true" tabindex="-1"></a>  absent_data <span class="ot">&lt;-</span> DATOSM_all_eyes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Absent"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="sc">!!</span>var)</span>
<span id="cb13-631"><a href="#cb13-631" aria-hidden="true" tabindex="-1"></a>  mean_absent <span class="ot">&lt;-</span> <span class="fu">mean</span>(absent_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-632"><a href="#cb13-632" aria-hidden="true" tabindex="-1"></a>  sd_absent <span class="ot">&lt;-</span> <span class="fu">sd</span>(absent_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-633"><a href="#cb13-633" aria-hidden="true" tabindex="-1"></a>  n_absent <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(absent_data))</span>
<span id="cb13-634"><a href="#cb13-634" aria-hidden="true" tabindex="-1"></a>  absent_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_absent, sd_absent)</span>
<span id="cb13-635"><a href="#cb13-635" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-636"><a href="#cb13-636" aria-hidden="true" tabindex="-1"></a>  present_data <span class="ot">&lt;-</span> DATOSM_all_eyes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Present"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="sc">!!</span>var)</span>
<span id="cb13-637"><a href="#cb13-637" aria-hidden="true" tabindex="-1"></a>  mean_present <span class="ot">&lt;-</span> <span class="fu">mean</span>(present_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-638"><a href="#cb13-638" aria-hidden="true" tabindex="-1"></a>  sd_present <span class="ot">&lt;-</span> <span class="fu">sd</span>(present_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-639"><a href="#cb13-639" aria-hidden="true" tabindex="-1"></a>  n_present <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(present_data))</span>
<span id="cb13-640"><a href="#cb13-640" aria-hidden="true" tabindex="-1"></a>  present_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f ± %.2f"</span>, mean_present, sd_present)</span>
<span id="cb13-641"><a href="#cb13-641" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-642"><a href="#cb13-642" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(n_absent <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> n_present <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb13-643"><a href="#cb13-643" aria-hidden="true" tabindex="-1"></a>    t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(absent_data, present_data)</span>
<span id="cb13-644"><a href="#cb13-644" aria-hidden="true" tabindex="-1"></a>    w_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(absent_data, present_data)</span>
<span id="cb13-645"><a href="#cb13-645" aria-hidden="true" tabindex="-1"></a>    t_p <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, t_test<span class="sc">$</span>p.value)</span>
<span id="cb13-646"><a href="#cb13-646" aria-hidden="true" tabindex="-1"></a>    w_p <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, w_test<span class="sc">$</span>p.value)</span>
<span id="cb13-647"><a href="#cb13-647" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-648"><a href="#cb13-648" aria-hidden="true" tabindex="-1"></a>    t_p <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb13-649"><a href="#cb13-649" aria-hidden="true" tabindex="-1"></a>    w_p <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb13-650"><a href="#cb13-650" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-651"><a href="#cb13-651" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-652"><a href="#cb13-652" aria-hidden="true" tabindex="-1"></a>  TABLA3_rows[[<span class="fu">length</span>(TABLA3_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-653"><a href="#cb13-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-654"><a href="#cb13-654" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Absent (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> absent_stats,</span>
<span id="cb13-655"><a href="#cb13-655" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Present (Mean ± SD)</span><span class="st">`</span> <span class="ot">=</span> present_stats,</span>
<span id="cb13-656"><a href="#cb13-656" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">n (Absent/Present)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d"</span>, n_absent, n_present),</span>
<span id="cb13-657"><a href="#cb13-657" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (t-test)</span><span class="st">`</span> <span class="ot">=</span> t_p,</span>
<span id="cb13-658"><a href="#cb13-658" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value (Wilcoxon)</span><span class="st">`</span> <span class="ot">=</span> w_p,</span>
<span id="cb13-659"><a href="#cb13-659" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-660"><a href="#cb13-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-661"><a href="#cb13-661" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-662"><a href="#cb13-662" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-663"><a href="#cb13-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-664"><a href="#cb13-664" aria-hidden="true" tabindex="-1"></a>TABLA3_atrophy <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA3_rows)</span>
<span id="cb13-665"><a href="#cb13-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-666"><a href="#cb13-666" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 4: CORRELACIONES CON FRISEN (TODOS LOS OJOS)</span></span>
<span id="cb13-667"><a href="#cb13-667" aria-hidden="true" tabindex="-1"></a>TABLA4_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-668"><a href="#cb13-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-669"><a href="#cb13-669" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> vars_to_test) {</span>
<span id="cb13-670"><a href="#cb13-670" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb13-671"><a href="#cb13-671" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-672"><a href="#cb13-672" aria-hidden="true" tabindex="-1"></a>  spear_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(DATOSM_all_eyes<span class="sc">$</span>Frisen), </span>
<span id="cb13-673"><a href="#cb13-673" aria-hidden="true" tabindex="-1"></a>                         DATOSM_all_eyes[[var]], </span>
<span id="cb13-674"><a href="#cb13-674" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb13-675"><a href="#cb13-675" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-676"><a href="#cb13-676" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ya no necesitamos contar n_valid porque será fijo en el título</span></span>
<span id="cb13-677"><a href="#cb13-677" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-678"><a href="#cb13-678" aria-hidden="true" tabindex="-1"></a>  TABLA4_rows[[<span class="fu">length</span>(TABLA4_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-679"><a href="#cb13-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-680"><a href="#cb13-680" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Spearman rho</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, spear_test<span class="sc">$</span>estimate),</span>
<span id="cb13-681"><a href="#cb13-681" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, spear_test<span class="sc">$</span>p.value),</span>
<span id="cb13-682"><a href="#cb13-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-683"><a href="#cb13-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-684"><a href="#cb13-684" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-685"><a href="#cb13-685" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-686"><a href="#cb13-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-687"><a href="#cb13-687" aria-hidden="true" tabindex="-1"></a>TABLA4_frisen <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA4_rows)</span>
<span id="cb13-688"><a href="#cb13-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-689"><a href="#cb13-689" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-690"><a href="#cb13-690" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 5: VARIABLES CATEGÓRICAS CON ATROFIA (TODOS LOS OJOS)</span></span>
<span id="cb13-691"><a href="#cb13-691" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-692"><a href="#cb13-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-693"><a href="#cb13-693" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos categóricos expandidos</span></span>
<span id="cb13-694"><a href="#cb13-694" aria-hidden="true" tabindex="-1"></a>DATOSM3_eyes <span class="ot">&lt;-</span> Hiper1_eyes <span class="sc">%&gt;%</span></span>
<span id="cb13-695"><a href="#cb13-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-696"><a href="#cb13-696" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-697"><a href="#cb13-697" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Distención de vainas NO</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención de vainas NO</span><span class="st">`</span>, </span>
<span id="cb13-698"><a href="#cb13-698" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-699"><a href="#cb13-699" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aplanamiento posterior del globo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aplanamiento posterior del globo</span><span class="st">`</span>, </span>
<span id="cb13-700"><a href="#cb13-700" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-701"><a href="#cb13-701" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Protrusión del disco óptico</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Protrusión del disco óptico</span><span class="st">`</span>, </span>
<span id="cb13-702"><a href="#cb13-702" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-703"><a href="#cb13-703" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Realce del NO</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Realce del NO</span><span class="st">`</span>, </span>
<span id="cb13-704"><a href="#cb13-704" aria-hidden="true" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-705"><a href="#cb13-705" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meckel prominente</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meckel prominente</span><span class="st">`</span>, </span>
<span id="cb13-706"><a href="#cb13-706" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-707"><a href="#cb13-707" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Distención III NC</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Distención III NC</span><span class="st">`</span>, </span>
<span id="cb13-708"><a href="#cb13-708" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-709"><a href="#cb13-709" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Granulaciones Aracnoideas</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Granulaciones Aracnoideas</span><span class="st">`</span>, </span>
<span id="cb13-710"><a href="#cb13-710" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-711"><a href="#cb13-711" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meningocele</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningocele</span><span class="st">`</span>, </span>
<span id="cb13-712"><a href="#cb13-712" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-713"><a href="#cb13-713" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Meningoencefalocele</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Meningoencefalocele</span><span class="st">`</span>, </span>
<span id="cb13-714"><a href="#cb13-714" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-715"><a href="#cb13-715" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aracnoidocele Selar</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Aracnoidocele Selar</span><span class="st">`</span>, </span>
<span id="cb13-716"><a href="#cb13-716" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-717"><a href="#cb13-717" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Silla turca amplia aracnoidocele expansivo</span><span class="st">`</span>, </span>
<span id="cb13-718"><a href="#cb13-718" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-719"><a href="#cb13-719" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Descenso tonsilar</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Descenso tonsilar</span><span class="st">`</span>, </span>
<span id="cb13-720"><a href="#cb13-720" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>)),</span>
<span id="cb13-721"><a href="#cb13-721" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Estenosis seno sigmoideo</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">(I)_Estenosis seno sigmoideo</span><span class="st">`</span>, </span>
<span id="cb13-722"><a href="#cb13-722" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Present"</span>,<span class="st">"Absent"</span>))</span>
<span id="cb13-723"><a href="#cb13-723" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-724"><a href="#cb13-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-725"><a href="#cb13-725" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Distención de vainas NO"</span>, <span class="st">"Aplanamiento posterior del globo"</span>,</span>
<span id="cb13-726"><a href="#cb13-726" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Protrusión del disco óptico"</span>, <span class="st">"Realce del NO"</span>, <span class="st">"Meckel prominente"</span>,</span>
<span id="cb13-727"><a href="#cb13-727" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Distención III NC"</span>, <span class="st">"Granulaciones Aracnoideas"</span>, <span class="st">"Meningocele"</span>,</span>
<span id="cb13-728"><a href="#cb13-728" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Meningoencefalocele"</span>, <span class="st">"Aracnoidocele Selar"</span>, <span class="st">"Silla turca amplia aracnoidocele expansivo"</span>,</span>
<span id="cb13-729"><a href="#cb13-729" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Descenso tonsilar"</span>, <span class="st">"Estenosis seno sigmoideo"</span>)</span>
<span id="cb13-730"><a href="#cb13-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-731"><a href="#cb13-731" aria-hidden="true" tabindex="-1"></a>TABLA5_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-732"><a href="#cb13-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-733"><a href="#cb13-733" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb13-734"><a href="#cb13-734" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(var)</span>
<span id="cb13-735"><a href="#cb13-735" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-736"><a href="#cb13-736" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(DATOSM3_eyes[[var]], DATOSM3_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>)</span>
<span id="cb13-737"><a href="#cb13-737" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-738"><a href="#cb13-738" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(tbl) <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">&amp;&amp;</span> <span class="fu">ncol</span>(tbl) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb13-739"><a href="#cb13-739" aria-hidden="true" tabindex="-1"></a>    n_no_atrophy <span class="ot">&lt;-</span> tbl[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb13-740"><a href="#cb13-740" aria-hidden="true" tabindex="-1"></a>    total_no_atrophy <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl[,<span class="dv">2</span>])</span>
<span id="cb13-741"><a href="#cb13-741" aria-hidden="true" tabindex="-1"></a>    pct_no_atrophy <span class="ot">&lt;-</span> (n_no_atrophy <span class="sc">/</span> total_no_atrophy) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-742"><a href="#cb13-742" aria-hidden="true" tabindex="-1"></a>    no_atrophy_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d (%.1f)"</span>, n_no_atrophy, total_no_atrophy, pct_no_atrophy)</span>
<span id="cb13-743"><a href="#cb13-743" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-744"><a href="#cb13-744" aria-hidden="true" tabindex="-1"></a>    n_atrophy <span class="ot">&lt;-</span> tbl[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb13-745"><a href="#cb13-745" aria-hidden="true" tabindex="-1"></a>    total_atrophy <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl[,<span class="dv">1</span>])</span>
<span id="cb13-746"><a href="#cb13-746" aria-hidden="true" tabindex="-1"></a>    pct_atrophy <span class="ot">&lt;-</span> (n_atrophy <span class="sc">/</span> total_atrophy) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-747"><a href="#cb13-747" aria-hidden="true" tabindex="-1"></a>    atrophy_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%d/%d (%.1f)"</span>, n_atrophy, total_atrophy, pct_atrophy)</span>
<span id="cb13-748"><a href="#cb13-748" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-749"><a href="#cb13-749" aria-hidden="true" tabindex="-1"></a>    or_result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">oddsratio.fisher</span>(tbl)))</span>
<span id="cb13-750"><a href="#cb13-750" aria-hidden="true" tabindex="-1"></a>    or_val <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb13-751"><a href="#cb13-751" aria-hidden="true" tabindex="-1"></a>    or_lower <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb13-752"><a href="#cb13-752" aria-hidden="true" tabindex="-1"></a>    or_upper <span class="ot">&lt;-</span> or_result<span class="sc">$</span>measure[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb13-753"><a href="#cb13-753" aria-hidden="true" tabindex="-1"></a>    or_stats <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f (%.2f-%.2f)"</span>, or_val, or_lower, or_upper)</span>
<span id="cb13-754"><a href="#cb13-754" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-755"><a href="#cb13-755" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> or_result<span class="sc">$</span>p.value[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb13-756"><a href="#cb13-756" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-757"><a href="#cb13-757" aria-hidden="true" tabindex="-1"></a>    no_atrophy_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb13-758"><a href="#cb13-758" aria-hidden="true" tabindex="-1"></a>    atrophy_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb13-759"><a href="#cb13-759" aria-hidden="true" tabindex="-1"></a>    or_stats <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb13-760"><a href="#cb13-760" aria-hidden="true" tabindex="-1"></a>    p_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-761"><a href="#cb13-761" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-762"><a href="#cb13-762" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-763"><a href="#cb13-763" aria-hidden="true" tabindex="-1"></a>  TABLA5_rows[[<span class="fu">length</span>(TABLA5_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-764"><a href="#cb13-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-765"><a href="#cb13-765" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">No Atrophy n/N (%)</span><span class="st">`</span> <span class="ot">=</span> no_atrophy_stats,</span>
<span id="cb13-766"><a href="#cb13-766" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Atrophy n/N (%)</span><span class="st">`</span> <span class="ot">=</span> atrophy_stats,</span>
<span id="cb13-767"><a href="#cb13-767" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> or_stats,</span>
<span id="cb13-768"><a href="#cb13-768" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(p_val), <span class="st">"NA"</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_val)),</span>
<span id="cb13-769"><a href="#cb13-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-770"><a href="#cb13-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-771"><a href="#cb13-771" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-772"><a href="#cb13-772" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-773"><a href="#cb13-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-774"><a href="#cb13-774" aria-hidden="true" tabindex="-1"></a>TABLA5_cat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA5_rows)</span>
<span id="cb13-775"><a href="#cb13-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-776"><a href="#cb13-776" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-777"><a href="#cb13-777" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 6: REGRESIÓN LOGÍSTICA (TODOS LOS OJOS)</span></span>
<span id="cb13-778"><a href="#cb13-778" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-779"><a href="#cb13-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-780"><a href="#cb13-780" aria-hidden="true" tabindex="-1"></a>m_all_eyes <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span> <span class="sc">~</span> Edad <span class="sc">+</span> <span class="st">`</span><span class="at">Ancho del 3ro</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb13-781"><a href="#cb13-781" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>, </span>
<span id="cb13-782"><a href="#cb13-782" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> DATOSM_all_eyes, <span class="at">family =</span> binomial)</span>
<span id="cb13-783"><a href="#cb13-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-784"><a href="#cb13-784" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_all_eyes)</span>
<span id="cb13-785"><a href="#cb13-785" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">2</span>]</span>
<span id="cb13-786"><a href="#cb13-786" aria-hidden="true" tabindex="-1"></a>z_vals <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">3</span>]</span>
<span id="cb13-787"><a href="#cb13-787" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">summary</span>(m_all_eyes)<span class="sc">$</span>coefficients[,<span class="dv">4</span>]</span>
<span id="cb13-788"><a href="#cb13-788" aria-hidden="true" tabindex="-1"></a>or_vals <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefs)</span>
<span id="cb13-789"><a href="#cb13-789" aria-hidden="true" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">exp</span>(<span class="fu">confint</span>(m_all_eyes)))</span>
<span id="cb13-790"><a href="#cb13-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-791"><a href="#cb13-791" aria-hidden="true" tabindex="-1"></a>TABLA6_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-792"><a href="#cb13-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-793"><a href="#cb13-793" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(coefs)) {</span>
<span id="cb13-794"><a href="#cb13-794" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">clean_and_translate</span>(<span class="fu">names</span>(coefs)[i])</span>
<span id="cb13-795"><a href="#cb13-795" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-796"><a href="#cb13-796" aria-hidden="true" tabindex="-1"></a>  TABLA6_rows[[<span class="fu">length</span>(TABLA6_rows) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-797"><a href="#cb13-797" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> var_name,</span>
<span id="cb13-798"><a href="#cb13-798" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beta (SE)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f)"</span>, coefs[i], se[i]),</span>
<span id="cb13-799"><a href="#cb13-799" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, or_vals[i], conf_int[i,<span class="dv">1</span>], conf_int[i,<span class="dv">2</span>]),</span>
<span id="cb13-800"><a href="#cb13-800" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">z value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, z_vals[i]),</span>
<span id="cb13-801"><a href="#cb13-801" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_vals[i]),</span>
<span id="cb13-802"><a href="#cb13-802" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-803"><a href="#cb13-803" aria-hidden="true" tabindex="-1"></a>    <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-804"><a href="#cb13-804" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-805"><a href="#cb13-805" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-806"><a href="#cb13-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-807"><a href="#cb13-807" aria-hidden="true" tabindex="-1"></a>TABLA6_regression <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TABLA6_rows)</span>
<span id="cb13-808"><a href="#cb13-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-809"><a href="#cb13-809" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-810"><a href="#cb13-810" aria-hidden="true" tabindex="-1"></a><span class="co"># ANÁLISIS 7: CURVAS ROC (TODOS LOS OJOS)</span></span>
<span id="cb13-811"><a href="#cb13-811" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-812"><a href="#cb13-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-813"><a href="#cb13-813" aria-hidden="true" tabindex="-1"></a>roc_csf <span class="ot">&lt;-</span> <span class="fu">roc</span>(DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Presión LCR</span><span class="st">`</span>, </span>
<span id="cb13-814"><a href="#cb13-814" aria-hidden="true" tabindex="-1"></a>               <span class="at">auc=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-815"><a href="#cb13-815" aria-hidden="true" tabindex="-1"></a>roc_thalamo <span class="ot">&lt;-</span> <span class="fu">roc</span>(DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">CV atrofia</span><span class="st">`</span>, DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Distancia talamomesencefalica</span><span class="st">`</span>, </span>
<span id="cb13-816"><a href="#cb13-816" aria-hidden="true" tabindex="-1"></a>                   <span class="at">auc=</span><span class="cn">TRUE</span>, <span class="at">ci=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-817"><a href="#cb13-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-818"><a href="#cb13-818" aria-hidden="true" tabindex="-1"></a>coords_csf <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_csf, <span class="st">"best"</span>)</span>
<span id="cb13-819"><a href="#cb13-819" aria-hidden="true" tabindex="-1"></a>coords_thalamo <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_thalamo, <span class="st">"best"</span>)</span>
<span id="cb13-820"><a href="#cb13-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-821"><a href="#cb13-821" aria-hidden="true" tabindex="-1"></a>TABLA7_roc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-822"><a href="#cb13-822" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"CSF Pressure"</span>, <span class="st">"Thalamo-mesencephalic distance"</span>),</span>
<span id="cb13-823"><a href="#cb13-823" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">AUC (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb13-824"><a href="#cb13-824" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, roc_csf<span class="sc">$</span>auc, roc_csf<span class="sc">$</span>ci[<span class="dv">1</span>], roc_csf<span class="sc">$</span>ci[<span class="dv">3</span>]),</span>
<span id="cb13-825"><a href="#cb13-825" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.3f-%.3f)"</span>, roc_thalamo<span class="sc">$</span>auc, roc_thalamo<span class="sc">$</span>ci[<span class="dv">1</span>], roc_thalamo<span class="sc">$</span>ci[<span class="dv">3</span>])</span>
<span id="cb13-826"><a href="#cb13-826" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-827"><a href="#cb13-827" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Optimal Cutoff</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb13-828"><a href="#cb13-828" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, coords_csf<span class="sc">$</span>threshold),</span>
<span id="cb13-829"><a href="#cb13-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, coords_thalamo<span class="sc">$</span>threshold)</span>
<span id="cb13-830"><a href="#cb13-830" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-831"><a href="#cb13-831" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Sensitivity/Specificity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb13-832"><a href="#cb13-832" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f/%.1f"</span>, coords_csf<span class="sc">$</span>sensitivity<span class="sc">*</span><span class="dv">100</span>, coords_csf<span class="sc">$</span>specificity<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb13-833"><a href="#cb13-833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f/%.1f"</span>, coords_thalamo<span class="sc">$</span>sensitivity<span class="sc">*</span><span class="dv">100</span>, coords_thalamo<span class="sc">$</span>specificity<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb13-834"><a href="#cb13-834" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-835"><a href="#cb13-835" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-836"><a href="#cb13-836" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-837"><a href="#cb13-837" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-838"><a href="#cb13-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-839"><a href="#cb13-839" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-840"><a href="#cb13-840" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR DATATABLES INTERACTIVAS</span></span>
<span id="cb13-841"><a href="#cb13-841" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb13-842"><a href="#cb13-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-843"><a href="#cb13-843" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataTable interactiva</span></span>
<span id="cb13-844"><a href="#cb13-844" aria-hidden="true" tabindex="-1"></a>dt0 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA0_BASELINE,</span>
<span id="cb13-845"><a href="#cb13-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 0: Complete Baseline Characteristics of Study Sample"</span>,</span>
<span id="cb13-846"><a href="#cb13-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb13-847"><a href="#cb13-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-848"><a href="#cb13-848" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-849"><a href="#cb13-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-850"><a href="#cb13-850" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-851"><a href="#cb13-851" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb13-852"><a href="#cb13-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">50</span></span>
<span id="cb13-853"><a href="#cb13-853" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-854"><a href="#cb13-854" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-855"><a href="#cb13-855" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-856"><a href="#cb13-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb13-857"><a href="#cb13-857" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-858"><a href="#cb13-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-859"><a href="#cb13-859" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 1: Variables continuas Pre-Post</span></span>
<span id="cb13-860"><a href="#cb13-860" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA1,</span>
<span id="cb13-861"><a href="#cb13-861" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 1: Pre-Post Analysis of Continuous Variables (Patient-level)"</span>,</span>
<span id="cb13-862"><a href="#cb13-862" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb13-863"><a href="#cb13-863" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-864"><a href="#cb13-864" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-865"><a href="#cb13-865" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-866"><a href="#cb13-866" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-867"><a href="#cb13-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb13-868"><a href="#cb13-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb13-869"><a href="#cb13-869" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-870"><a href="#cb13-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-871"><a href="#cb13-871" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-872"><a href="#cb13-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb13-873"><a href="#cb13-873" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-874"><a href="#cb13-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-875"><a href="#cb13-875" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 2: Variables categóricas Pre-Post</span></span>
<span id="cb13-876"><a href="#cb13-876" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA2,</span>
<span id="cb13-877"><a href="#cb13-877" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 2: Pre-Post Analysis of Categorical Variables (Patient-level)"</span>,</span>
<span id="cb13-878"><a href="#cb13-878" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb13-879"><a href="#cb13-879" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-880"><a href="#cb13-880" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-881"><a href="#cb13-881" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-882"><a href="#cb13-882" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-883"><a href="#cb13-883" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb13-884"><a href="#cb13-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb13-885"><a href="#cb13-885" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-886"><a href="#cb13-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-887"><a href="#cb13-887" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-888"><a href="#cb13-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb13-889"><a href="#cb13-889" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-890"><a href="#cb13-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-891"><a href="#cb13-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 3: Análisis de atrofia</span></span>
<span id="cb13-892"><a href="#cb13-892" aria-hidden="true" tabindex="-1"></a>dt3 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA3_atrophy,</span>
<span id="cb13-893"><a href="#cb13-893" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 3: Continuous Variables by ON Atrophy Status (All Eyes as Units)"</span>,</span>
<span id="cb13-894"><a href="#cb13-894" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb13-895"><a href="#cb13-895" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-896"><a href="#cb13-896" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-897"><a href="#cb13-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-898"><a href="#cb13-898" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-899"><a href="#cb13-899" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb13-900"><a href="#cb13-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb13-901"><a href="#cb13-901" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-902"><a href="#cb13-902" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-903"><a href="#cb13-903" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-904"><a href="#cb13-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb13-905"><a href="#cb13-905" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-906"><a href="#cb13-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-907"><a href="#cb13-907" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear DataTable con n=42 en el título</span></span>
<span id="cb13-908"><a href="#cb13-908" aria-hidden="true" tabindex="-1"></a>dt4 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA4_frisen,</span>
<span id="cb13-909"><a href="#cb13-909" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 4: Spearman Correlations with Frisen Grade (All Eyes, n=42)"</span>,  <span class="co"># n=42 en el título</span></span>
<span id="cb13-910"><a href="#cb13-910" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb13-911"><a href="#cb13-911" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-912"><a href="#cb13-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-913"><a href="#cb13-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-914"><a href="#cb13-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb13-915"><a href="#cb13-915" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-916"><a href="#cb13-916" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-917"><a href="#cb13-917" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-918"><a href="#cb13-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">3</span>,  <span class="co"># Ahora la columna p-value es la 3 en lugar de la 4</span></span>
<span id="cb13-919"><a href="#cb13-919" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-920"><a href="#cb13-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-921"><a href="#cb13-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 5: Variables categóricas con atrofia</span></span>
<span id="cb13-922"><a href="#cb13-922" aria-hidden="true" tabindex="-1"></a>dt5 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA5_cat,</span>
<span id="cb13-923"><a href="#cb13-923" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 5: Categorical Variables by ON Atrophy Status (All Eyes as Units)"</span>,</span>
<span id="cb13-924"><a href="#cb13-924" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'FixedColumns'</span>),</span>
<span id="cb13-925"><a href="#cb13-925" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-926"><a href="#cb13-926" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-927"><a href="#cb13-927" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-928"><a href="#cb13-928" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-929"><a href="#cb13-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="fu">list</span>(<span class="at">leftColumns =</span> <span class="dv">1</span>),</span>
<span id="cb13-930"><a href="#cb13-930" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">15</span></span>
<span id="cb13-931"><a href="#cb13-931" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-932"><a href="#cb13-932" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-933"><a href="#cb13-933" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-934"><a href="#cb13-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb13-935"><a href="#cb13-935" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-936"><a href="#cb13-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-937"><a href="#cb13-937" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 6: Regresión logística</span></span>
<span id="cb13-938"><a href="#cb13-938" aria-hidden="true" tabindex="-1"></a>dt6 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA6_regression,</span>
<span id="cb13-939"><a href="#cb13-939" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 6: Logistic Regression Model for ON Atrophy (All Eyes as Units)"</span>,</span>
<span id="cb13-940"><a href="#cb13-940" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb13-941"><a href="#cb13-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-942"><a href="#cb13-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-943"><a href="#cb13-943" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-944"><a href="#cb13-944" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span></span>
<span id="cb13-945"><a href="#cb13-945" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-946"><a href="#cb13-946" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-947"><a href="#cb13-947" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-948"><a href="#cb13-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(<span class="at">columns =</span> <span class="dv">5</span>,</span>
<span id="cb13-949"><a href="#cb13-949" aria-hidden="true" tabindex="-1"></a>              <span class="at">backgroundColor =</span> <span class="fu">styleInterval</span>(<span class="fl">0.05</span>, <span class="fu">c</span>(<span class="st">'lightcoral'</span>, <span class="st">'white'</span>)))</span>
<span id="cb13-950"><a href="#cb13-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-951"><a href="#cb13-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla 7: Análisis ROC</span></span>
<span id="cb13-952"><a href="#cb13-952" aria-hidden="true" tabindex="-1"></a>dt7 <span class="ot">&lt;-</span> <span class="fu">datatable</span>(TABLA7_roc,</span>
<span id="cb13-953"><a href="#cb13-953" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 7: ROC Curve Analysis for ON Atrophy Prediction (All Eyes as Units)"</span>,</span>
<span id="cb13-954"><a href="#cb13-954" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>),</span>
<span id="cb13-955"><a href="#cb13-955" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb13-956"><a href="#cb13-956" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb13-957"><a href="#cb13-957" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span>),</span>
<span id="cb13-958"><a href="#cb13-958" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span></span>
<span id="cb13-959"><a href="#cb13-959" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-960"><a href="#cb13-960" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb13-961"><a href="#cb13-961" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-962"><a href="#cb13-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-963"><a href="#cb13-963" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar tablas</span></span>
<span id="cb13-964"><a href="#cb13-964" aria-hidden="true" tabindex="-1"></a>dt0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f7d95c92bf14e0086664" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f7d95c92bf14e0086664">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 0: Complete Baseline Characteristics of Study Sample<\/caption>","data":[["Age (years)","Sex (Female)","CSF Pressure (cmH2O)","Time without ACTZ (days)","ON width (mm)","Virchow Robin measurement (mm)","Meckel width (mm)","Meckel circumference (mm)","3rd ventricle width (mm)","Arachnoidocele height (mm)","Tonsillar descent (mm)","Nuchal SCT thickness (mm)","Thalamo-mesencephalic distance (mm)","Atrium (mm)","Frontal VL (mm)","Third Ventricle (mm)","ON atrophy OD","ON atrophy OI","Frisen Grade OD","Frisen Grade OI","Chronic headache","Other surgery","ON sheath distention","CN III distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","Meckel shape","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica","Tonsillar descent (categorical)","Sigmoid sinus stenosis"],["21.36 ± 9.38","5 (45.5)","38.95 ± 9.24","40.18 ± 34.02","6.77 ± 1.32","1.61 ± 0.63","3.19 ± 1.06","27.60 ± 4.64","2.54 ± 1.18","3.76 ± 1.73","0.25 ± 0.84","13.22 ± 5.75","3.67 ± 1.38","9.67 ± 2.24","3.87 ± 1.19","3.89 ± 0.68","6 (54.5)","5 (45.5)","4: 3 (27.3); 5: 8 (72.7)","3: 1 (9.1); 4: 2 (18.2); 5: 8 (72.7)","2 (18.2)","0 (0.0)","10 (90.9)","3 (27.3)","10 (90.9)","9 (81.8)","8 (72.7)","0 (0.0)","Type1: 0 (0.0); Type2: 11 (100.0); Type3: 0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","10 (90.9)","1 (9.1)","1 (9.1)","10 (90.9)"],["20.00 ± 7.48","3 (42.9)","39.00 ± 10.83","40.71 ± 38.37","6.87 ± 1.19","1.95 ± 0.52","3.24 ± 1.10","27.66 ± 5.69","2.87 ± 1.13","3.22 ± 1.97","0.40 ± 1.06","13.80 ± 6.90","3.17 ± 1.23","9.51 ± 2.20","4.01 ± 1.46","3.91 ± 0.68","4 (57.1)","3 (42.9)","4: 2 (28.6); 5: 5 (71.4)","3: 1 (14.3); 4: 1 (14.3); 5: 5 (71.4)","2 (28.6)","0 (0.0)","6 (85.7)","3 (42.9)","6 (85.7)","5 (71.4)","4 (57.1)","0 (0.0)","Type1: 0 (0.0); Type2: 7 (100.0); Type3: 0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","6 (85.7)","1 (14.3)","1 (14.3)","6 (85.7)"],["23.75 ± 13.02","2 (50.0)","38.88 ± 7.08","39.25 ± 30.19","6.60 ± 1.70","1.02 ± 0.25","3.10 ± 1.16","27.50 ± 2.65","1.95 ± 1.18","4.70 ± 0.65","0.00 ± 0.00","12.20 ± 3.58","4.55 ± 1.29","9.95 ± 2.63","3.62 ± 0.53","3.85 ± 0.78","2 (50.0)","2 (50.0)","4: 1 (25.0); 5: 3 (75.0)","3: 0 (0.0); 4: 1 (25.0); 5: 3 (75.0)","0 (0.0)","0 (0.0)","4 (100.0)","0 (0.0)","4 (100.0)","4 (100.0)","4 (100.0)","0 (0.0)","Type1: 0 (0.0); Type2: 4 (100.0); Type3: 0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","4 (100.0)","0 (0.0)","0 (0.0)","4 (100.0)"],["0.624","1.000","0.982","0.946","0.790","0.003","0.855","0.952","0.253","0.106","0.356","0.625","0.133","0.790","0.543","0.895","1.000","1.000","0.903","0.809","0.491","1.000","1.000","0.236","1.000","0.491","0.236","1.000","1.000","1.000","1.000","1.000","1.000","1.000","1.000","1.000"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Overall (n=11)<\/th>\n      <th>With Valve (n=7)<\/th>\n      <th>Without Valve (n=4)<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":50,"columnDefs":[{"name":"Variable","targets":0},{"name":"Overall (n=11)","targets":1},{"name":"With Valve (n=7)","targets":2},{"name":"Without Valve (n=4)","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dt1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-72402fbdecb7dd87d1f2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-72402fbdecb7dd87d1f2">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 1: Pre-Post Analysis of Continuous Variables (Patient-level)<\/caption>","data":[["ON width","Virchow Robin measurement","Meckel width","Meckel circumference","3rd ventricle width","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle"],["6.77 ± 1.32","1.61 ± 0.63","3.19 ± 1.06","27.60 ± 4.64","2.54 ± 1.18","3.76 ± 1.73","0.25 ± 0.84","13.22 ± 5.75","3.67 ± 1.38","9.67 ± 2.24","3.87 ± 1.19","3.89 ± 0.68"],["4.85 ± 1.53","1.75 ± 0.53","4.59 ± 1.36","28.08 ± 6.17","2.96 ± 1.62","2.88 ± 2.66","0.26 ± 0.87","12.93 ± 4.74","3.25 ± 1.65","9.54 ± 2.36","3.53 ± 1.02","3.65 ± 0.69"],["0.0023","0.5629","0.0136","0.8186","0.3955","0.1109","0.3409","0.8402","0.1015","0.6053","0.2571","0.3045"],["4.21 ± 1.02","1.86 ± 0.65","4.16 ± 0.88","25.80 ± 4.12","2.61 ± 1.49","2.29 ± 3.06","0.41 ± 1.10","13.11 ± 5.36","2.59 ± 1.34","9.41 ± 2.62","3.79 ± 1.17","3.34 ± 0.67"],["5.97 ± 1.76","1.57 ± 0.17","5.35 ± 1.85","32.08 ± 7.70","3.58 ± 1.88","3.92 ± 1.61","0.00 ± 0.00","12.60 ± 4.13","4.42 ± 1.61","9.75 ± 2.17","3.08 ± 0.56","4.20 ± 0.23"],["0.0302","0.4092","0.1771","0.1131","0.1141","0.8770","0.2651","0.9095","0.4205","0.8811","0.3623","0.0179"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>T1 (Mean ± SD)<\/th>\n      <th>T2 (Mean ± SD)<\/th>\n      <th>p value (Paired t)<\/th>\n      <th>T2 with Valve<\/th>\n      <th>T2 without Valve<\/th>\n      <th>p value (ANCOVA)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"T1 (Mean ± SD)","targets":1},{"name":"T2 (Mean ± SD)","targets":2},{"name":"p value (Paired t)","targets":3},{"name":"T2 with Valve","targets":4},{"name":"T2 without Valve","targets":5},{"name":"p value (ANCOVA)","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-19bc02bf629763111392" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-19bc02bf629763111392">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 2: Pre-Post Analysis of Categorical Variables (Patient-level)<\/caption>","data":[["ON sheath distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","CN III distention","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica with expansive arachnoidocele","Tonsillar descent","Sigmoid sinus stenosis"],["10 (90.9)","10 (90.9)","9 (81.8)","8 (72.7)","0 (0.0)","3 (27.3)","0 (0.0)","0 (0.0)","0 (0.0)","10 (90.9)","1 (9.1)","1 (9.1)","10 (90.9)"],["4 (36.4)","4 (36.4)","0 (0.0)","0 (0.0)","2 (18.2)","1 (9.1)","0 (0.0)","0 (0.0)","0 (0.0)","7 (63.6)","4 (36.4)","1 (9.1)","5 (45.5)"],["0.0412","0.0412","0.0077","0.0133","0.4795","0.6171","NaN","NaN","NaN","0.2482","0.2482","NaN","0.0736"],["2 (28.6)","2 (28.6)","0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","0 (0.0)","3 (42.9)","2 (28.6)","1 (14.3)","2 (28.6)"],["2 (50.0)","2 (50.0)","0 (0.0)","0 (0.0)","2 (50.0)","1 (25.0)","0 (0.0)","0 (0.0)","0 (0.0)","4 (100.0)","2 (50.0)","0 (0.0)","3 (75.0)"],["0.9528","0.9528","NaN","NaN","0.2092","0.7662","NaN","NaN","NaN","0.2136","0.9528","1.0000","0.3907"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>T1 n (%)<\/th>\n      <th>T2 n (%)<\/th>\n      <th>p value (McNemar)<\/th>\n      <th>T2 with Valve n (%)<\/th>\n      <th>T2 without Valve n (%)<\/th>\n      <th>p value (Chi-square)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"T1 n (%)","targets":1},{"name":"T2 n (%)","targets":2},{"name":"p value (McNemar)","targets":3},{"name":"T2 with Valve n (%)","targets":4},{"name":"T2 without Valve n (%)","targets":5},{"name":"p value (Chi-square)","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dt3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac228edc59db128c5f7a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac228edc59db128c5f7a">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 3: Continuous Variables by ON Atrophy Status (All Eyes as Units)<\/caption>","data":[["Age","ON width","3rd ventricle width","Virchow Robin measurement","Meckel width","Meckel circumference","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle","CSF Pressure"],["23.00 ± 11.50","7.22 ± 1.21","2.20 ± 1.19","1.80 ± 0.58","3.35 ± 1.25","29.33 ± 5.50","3.67 ± 1.24","0.00 ± 0.00","12.12 ± 4.51","2.85 ± 1.14","10.28 ± 2.58","4.24 ± 1.26","3.68 ± 0.53","35.27 ± 4.67"],["19.73 ± 6.17","6.33 ± 1.25","2.87 ± 1.06","1.43 ± 0.62","3.03 ± 0.80","25.87 ± 2.49","3.85 ± 2.11","0.51 ± 1.13","14.32 ± 6.56","4.49 ± 1.00","9.06 ± 1.61","3.51 ± 0.97","4.10 ± 0.73","42.64 ± 10.92"],["11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11","11/11"],["0.4182","0.1050","0.1780","0.1590","0.4865","0.0787","0.8180","0.1669","0.3718","0.0020","0.2021","0.1457","0.1440","0.0595"],["0.7159","0.1567","0.1990","0.0923","0.1938","0.0915","0.3728","0.1666","0.6213","0.0007","0.3073","0.0266","0.2760","0.1208"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Absent (Mean ± SD)<\/th>\n      <th>Present (Mean ± SD)<\/th>\n      <th>n (Absent/Present)<\/th>\n      <th>p value (t-test)<\/th>\n      <th>p value (Wilcoxon)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"Absent (Mean ± SD)","targets":1},{"name":"Present (Mean ± SD)","targets":2},{"name":"n (Absent/Present)","targets":3},{"name":"p value (t-test)","targets":4},{"name":"p value (Wilcoxon)","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dt4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f8c575dd4adf4cdc0c82" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f8c575dd4adf4cdc0c82">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 4: Spearman Correlations with Frisen Grade (All Eyes, n=42)<\/caption>","data":[["Age","ON width","3rd ventricle width","Virchow Robin measurement","Meckel width","Meckel circumference","Arachnoidocele height","Quantitative tonsillar descent","Nuchal SCT thickness","Thalamo-mesencephalic distance","Atrium","Frontal VL","Third Ventricle","CSF Pressure"],["-0.373","0.052","-0.061","0.000","-0.389","-0.154","0.018","0.192","0.140","0.280","0.306","0.443","-0.074","0.412"],["0.0872","0.8167","0.7868","1.0000","0.0735","0.4948","0.9383","0.3913","0.5348","0.2074","0.1662","0.0387","0.7419","0.0569"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Spearman rho<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"Spearman rho","targets":1},{"name":"p value","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dt5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-146c4609323e3ceabcd5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-146c4609323e3ceabcd5">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","FixedColumns"],"caption":"<caption>Table 5: Categorical Variables by ON Atrophy Status (All Eyes as Units)<\/caption>","data":[["ON sheath distention","Posterior globe flattening","Optic disc protrusion","ON enhancement","Prominent Meckel","CN III distention","Arachnoid granulations","Meningocele","Meningoencephalocele","Sellar arachnoidocele","Enlarged sella turcica with expansive arachnoidocele","Tonsillar descent","Sigmoid sinus stenosis"],["11/11 (100.0)","10/11 (90.9)","8/11 (72.7)","8/11 (72.7)","0/11 (0.0)","4/11 (36.4)","0/11 (0.0)","0/11 (0.0)","0/11 (0.0)","11/11 (100.0)","0/11 (0.0)","0/11 (0.0)","11/11 (100.0)"],["9/11 (81.8)","10/11 (90.9)","10/11 (90.9)","8/11 (72.7)","0/11 (0.0)","2/11 (18.2)","0/11 (0.0)","0/11 (0.0)","0/11 (0.0)","9/11 (81.8)","2/11 (18.2)","2/11 (18.2)","9/11 (81.8)"],["0.00 (0.00-5.24)","1.00 (0.01-86.19)","3.54 (0.23-215.85)","1.00 (0.10-9.94)","0.00 (0.00-Inf)","0.41 (0.03-3.84)","0.00 (0.00-Inf)","0.00 (0.00-Inf)","0.00 (0.00-Inf)","0.00 (0.00-5.24)","Inf (0.19-Inf)","Inf (0.19-Inf)","0.00 (0.00-5.24)"],["0.4762","1.0000","0.5865","1.0000","1.0000","0.6351","1.0000","1.0000","1.0000","0.4762","0.4762","0.4762","0.4762"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>No Atrophy n/N (%)<\/th>\n      <th>Atrophy n/N (%)<\/th>\n      <th>OR (95% CI)<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"scrollX":true,"fixedColumns":{"leftColumns":1},"pageLength":15,"columnDefs":[{"name":"Variable","targets":0},{"name":"No Atrophy n/N (%)","targets":1},{"name":"Atrophy n/N (%)","targets":2},{"name":"OR (95% CI)","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dt6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c7f2909238756c0eea1a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c7f2909238756c0eea1a">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 6: Logistic Regression Model for ON Atrophy (All Eyes as Units)<\/caption>","data":[["(Intercept)","Age","`3rd ventricle width`","`Thalamo-mesencephalic distance`","`CSF Pressure`"],["-548.043 (321575.086)","3.984 (2381.494)","58.701 (38063.222)","42.134 (42569.856)","4.224 (6037.188)"],["0.000 (0.000-Inf)","53.746 (0.000-108496264314784448978402640826206420204460046882482444864606288642882864.000)","31146515027947012014880026.000 (0.000-Inf)","1988076683436293120.000 (0.000-Inf)","68.282 (0.000-Inf)"],["-0.002","0.002","0.002","0.001","0.001"],["0.9986","0.9987","0.9988","0.9992","0.9994"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Beta (SE)<\/th>\n      <th>OR (95% CI)<\/th>\n      <th>z value<\/th>\n      <th>p value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":10,"columnDefs":[{"name":"Variable","targets":0},{"name":"Beta (SE)","targets":1},{"name":"OR (95% CI)","targets":2},{"name":"z value","targets":3},{"name":"p value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background-color':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightcoral\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dt7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-28f6c9c341a8a3ceeabd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-28f6c9c341a8a3ceeabd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"caption":"<caption>Table 7: ROC Curve Analysis for ON Atrophy Prediction (All Eyes as Units)<\/caption>","data":[["CSF Pressure","Thalamo-mesencephalic distance"],["0.698 (0.459-0.938)","0.930 (0.790-1.000)"],["44.8","3.8"],["54.5/100.0","90.9/100.0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>AUC (95% CI)<\/th>\n      <th>Optimal Cutoff<\/th>\n      <th>Sensitivity/Specificity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":10,"columnDefs":[{"name":"Variable","targets":0},{"name":"AUC (95% CI)","targets":1},{"name":"Optimal Cutoff","targets":2},{"name":"Sensitivity/Specificity","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CREAR FIGURAS</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURA 1 CORREGIDA - USANDO DIRECTAMENTE DATOS DE TABLA 1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># =====================================================================</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Primero, vamos a recrear la Tabla 1 para tener los valores exactos</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># y luego usarlos directamente para la figura</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 1: Recalcular Tabla 1 para asegurar consistencia</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>HiperOrd <span class="ot">&lt;-</span> Hiper1[,<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">49</span><span class="sc">:</span><span class="dv">52</span>,<span class="dv">55</span><span class="sc">:</span><span class="dv">58</span>,<span class="dv">59</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">61</span><span class="sc">:</span><span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>,<span class="dv">71</span>)]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir a numérico</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>cols_to_check <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">26</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(col <span class="cf">in</span> cols_to_check) {</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  HiperOrd[,col] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[col]])</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar válvula derivativa</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>,<span class="st">"No"</span>))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 2: Crear dataframe para gráfico directamente desde los cálculos</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables a incluir (índices de columnas en pares)</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>var_pairs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>var_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ON width"</span>, <span class="st">"Virchow Robin measurement"</span>, <span class="st">"Meckel width"</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Meckel circumference"</span>, <span class="st">"3rd ventricle width"</span>, <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Quantitative tonsillar descent"</span>, <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Thalamo-mesencephalic distance"</span>, <span class="st">"Atrium"</span>, <span class="st">"Frontal VL"</span>, <span class="st">"Third Ventricle"</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var_pairs)) {</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> var_pairs[i]</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T1 - Overall</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  vals_t1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[idx]])</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  mean_t1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  sd_t1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  n_t1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1))</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  se_t1 <span class="ot">&lt;-</span> sd_t1<span class="sc">/</span><span class="fu">sqrt</span>(n_t1)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - Overall</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  vals_t2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(HiperOrd[[idx<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  mean_t2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  sd_t2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  n_t2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2))</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  se_t2 <span class="ot">&lt;-</span> sd_t2<span class="sc">/</span><span class="fu">sqrt</span>(n_t2)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - With Valve</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  vals_t2_valve <span class="ot">&lt;-</span> vals_t2[valve_mask]</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  mean_t2_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  sd_t2_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  n_t2_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2_valve))</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  se_t2_valve <span class="ot">&lt;-</span> sd_t2_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t2_valve)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T2 - Without Valve</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>  no_valve_mask <span class="ot">&lt;-</span> HiperOrd<span class="sc">$</span><span class="st">`</span><span class="at">Válvula derivativa</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  vals_t2_no_valve <span class="ot">&lt;-</span> vals_t2[no_valve_mask]</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>  mean_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t2_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  sd_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t2_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  n_t2_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t2_no_valve))</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  se_t2_no_valve <span class="ot">&lt;-</span> sd_t2_no_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t2_no_valve)</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Para el gráfico, necesitamos T1 y T2 para cada grupo</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Asumiendo que T1 es igual para ambos grupos (pre-tratamiento)</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Necesitamos T1 para cada grupo</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  vals_t1_valve <span class="ot">&lt;-</span> vals_t1[valve_mask]</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>  mean_t1_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>  sd_t1_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>  n_t1_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1_valve))</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>  se_t1_valve <span class="ot">&lt;-</span> sd_t1_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t1_valve)</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  vals_t1_no_valve <span class="ot">&lt;-</span> vals_t1[no_valve_mask]</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>  mean_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">mean</span>(vals_t1_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>  sd_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">sd</span>(vals_t1_no_valve, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>  n_t1_no_valve <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(vals_t1_no_valve))</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>  se_t1_no_valve <span class="ot">&lt;-</span> sd_t1_no_valve<span class="sc">/</span><span class="fu">sqrt</span>(n_t1_no_valve)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Agregar datos al dataframe</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grupo con válvula</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot_data,</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Surgical Treatment"</span>,</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Pre"</span>,</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t1_valve,</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t1_valve,</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t1_valve,</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t1_valve</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Surgical Treatment"</span>,</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Post"</span>,</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t2_valve,</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t2_valve,</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t2_valve,</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t2_valve</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Grupo sin válvula</span></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Medical Treatment"</span>,</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Pre"</span>,</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t1_no_valve,</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t1_no_valve,</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t1_no_valve,</span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t1_no_valve</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> var_names[i],</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">Treatment =</span> <span class="st">"Medical Treatment"</span>,</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span> <span class="st">"Post"</span>,</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> mean_t2_no_valve,</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> sd_t2_no_valve,</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">SE =</span> se_t2_no_valve,</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> n_t2_no_valve</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular intervalos de confianza al 95%</span></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>CI_lower <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>Mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> plot_data<span class="sc">$</span>SE</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>CI_upper <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>Mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> plot_data<span class="sc">$</span>SE</span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Factorizar variables para el gráfico</span></span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_data<span class="sc">$</span>Time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>))</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>plot_data<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_data<span class="sc">$</span>Treatment, </span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span>, <span class="st">"Medical Treatment"</span>))</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a><span class="co"># PASO 4: Crear la figura con los valores correctos</span></span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables seleccionadas para mostrar</span></span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ON width"</span>, <span class="st">"3rd ventricle width"</span>, <span class="st">"Arachnoidocele height"</span>,</span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Quantitative tonsillar descent"</span>, <span class="st">"Nuchal SCT thickness"</span>,</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Thalamo-mesencephalic distance"</span>, <span class="st">"Atrium"</span>, <span class="st">"Third Ventricle"</span>)</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span> </span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Variable <span class="sc">%in%</span> selected_vars) <span class="sc">%&gt;%</span></span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean, <span class="at">group =</span> Treatment, <span class="at">color =</span> Treatment, </span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> Treatment, <span class="at">shape =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), </span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="st">"grey50"</span>)) <span class="sc">+</span></span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="st">"solid"</span>, </span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="st">"longdash"</span>)) <span class="sc">+</span></span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Surgical Treatment"</span> <span class="ot">=</span> <span class="dv">16</span>, </span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Medical Treatment"</span> <span class="ot">=</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean ± 95% CI (mm)"</span>) <span class="sc">+</span></span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Variable, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Treatment Type:"</span>,</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolution of MRI Parameters by Treatment Group"</span>,</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Pre-Post Comparison with 95% Confidence Intervals"</span></span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar figura</span></span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure1.png"</span>, p1, </span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">device =</span> <span class="st">'png'</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 2: Boxplots para atrofia del NO (todos los ojos)</span></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>compara_pares <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Absent"</span>, <span class="st">"Present"</span>))</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>fig2a <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Descenso tonsilar cuantitativo"</span>,</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Quantitative tonsillar descent (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>fig2b <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Distancia talamomesencefalica"</span>,</span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Thalamo-mesencephalic distance (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>fig2c <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Presión LCR"</span>,</span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"t.test"</span>) <span class="sc">+</span> </span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"CSF Pressure (cmH2O)"</span>) <span class="sc">+</span> </span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a>fig2d <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(DATOSM_all_eyes,</span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Atrio"</span>,</span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"grey50"</span>, <span class="st">"grey10"</span>),</span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="st">"CV atrofia"</span>,</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"jitter"</span>,</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>          <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> compara_pares, <span class="at">method =</span> <span class="st">"wilcox.test"</span>) <span class="sc">+</span> </span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"ON Atrophy"</span>) <span class="sc">+</span> </span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Atrium (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig2a, fig2b, fig2c, fig2d, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure2.png"</span>, p2, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, </span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>)</span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 3: Curvas ROC</span></span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a>roc_csf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensitivity =</span> roc_csf<span class="sc">$</span>sensitivities,</span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">specificity =</span> roc_csf<span class="sc">$</span>specificities,</span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_csf<span class="sc">$</span>specificities</span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a>roc_thalamo_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">sensitivity =</span> roc_thalamo<span class="sc">$</span>sensitivities,</span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">specificity =</span> roc_thalamo<span class="sc">$</span>specificities,</span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">FPR =</span> <span class="dv">1</span> <span class="sc">-</span> roc_thalamo<span class="sc">$</span>specificities</span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a>optimal_csf <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_csf, <span class="st">"best"</span>)</span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a>optimal_thalamo <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_thalamo, <span class="st">"best"</span>)</span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>fig3a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_csf_df, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> optimal_csf<span class="sc">$</span>specificity, <span class="at">y =</span> optimal_csf<span class="sc">$</span>sensitivity),</span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(roc_csf<span class="sc">$</span>auc, <span class="dv">3</span>),</span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">CI: "</span>, <span class="fu">round</span>(roc_csf<span class="sc">$</span>ci[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>, </span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc_csf<span class="sc">$</span>ci[<span class="dv">3</span>], <span class="dv">3</span>),</span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">Optimal cutoff: "</span>, <span class="fu">round</span>(optimal_csf<span class="sc">$</span>threshold, <span class="dv">2</span>)),</span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve: CSF Pressure for ON Atrophy Prediction"</span>,</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a>fig3b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_thalamo_df, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> optimal_thalamo<span class="sc">$</span>specificity, <span class="at">y =</span> optimal_thalamo<span class="sc">$</span>sensitivity),</span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"AUC = "</span>, <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>auc, <span class="dv">3</span>),</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">CI: "</span>, <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>ci[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"-"</span>, </span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc_thalamo<span class="sc">$</span>ci[<span class="dv">3</span>], <span class="dv">3</span>),</span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">Optimal cutoff: "</span>, <span class="fu">round</span>(optimal_thalamo<span class="sc">$</span>threshold, <span class="dv">2</span>)),</span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ROC Curve: Thalamo-mesencephalic Distance for ON Atrophy Prediction"</span>,</span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig3a, fig3b, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure3.png"</span>, p3, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">5</span>, </span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 4: Correlaciones con Grado Frisen (todos los ojos)</span></span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a>DATOSM_all_eyes<span class="sc">$</span><span class="st">`</span><span class="at">Frisen n</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(DATOSM_all_eyes<span class="sc">$</span>Frisen)</span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a>fig4a <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Presión LCR"</span>, </span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"CSF Pressure (cmH2O)"</span>) <span class="sc">+</span></span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>fig4b <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Distancia talamomesencefalica"</span>, </span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Thalamo-mesencephalic distance (mm)"</span>) <span class="sc">+</span></span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a>fig4c <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Edad"</span>, </span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Age (years)"</span>) <span class="sc">+</span></span>
<span id="cb21-325"><a href="#cb21-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a>fig4d <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(DATOSM_all_eyes, <span class="at">x =</span> <span class="st">"Frisen n"</span>, <span class="at">y =</span> <span class="st">"Ancho del Meckel"</span>, </span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="st">"reg.line"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a>          <span class="at">cor.coef =</span> <span class="cn">TRUE</span>, <span class="at">cor.method =</span> <span class="st">"spearman"</span>,</span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Frisen Grade"</span>, <span class="at">ylab =</span> <span class="st">"Meckel width (mm)"</span>) <span class="sc">+</span></span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig4a, fig4b, fig4c, fig4d, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure4.png"</span>, p4, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>, </span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a>       <span class="at">device=</span><span class="st">'png'</span>, <span class="at">dpi=</span><span class="dv">300</span>)</span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar figuras</span></span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stage1_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="stage1_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>